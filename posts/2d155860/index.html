<!DOCTYPE HTML>
<html>
<head>
    <!--Setting-->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta http-equiv="Cache-Control" content="no-siteapp">
    <meta name="renderer" content="webkit|ie-comp|ie-stand">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no,email=no,adress=no">
    <meta name="browsermode" content="application">
    <meta name="screen-orientation" content="portrait">
    <link rel="dns-prefetch" href="http://yoursite.com">
    <!--SEO-->



<meta name="robots" content="all" />
<meta name="google" content="all" />
<meta name="googlebot" content="all" />
<meta name="verify" content="all" />
    <!--Title-->


<title>ror-system-rails tutorial笔记 | Hexo</title>


    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">


    <link rel="icon" href="/favicon.ico">

    



<link rel="stylesheet" href="//cdn.bootcss.com/bootstrap/3.3.4/css/bootstrap.min.css?rev=3.3.4">
<link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="/css/style.css?rev=@@hash">




    
    <div class="hide">
    	<script src="https://s4.cnzz.com/z_stat.php?id=1263868967&web_id=1263868967" language="JavaScript"></script>
    </div>






    
</head>

<!--[if lte IE 8]>
<style>
    html{ font-size: 1em }
</style>
<![endif]-->
<!--[if lte IE 9]>
<div style="ie">你使用的浏览器版本过低，为了你更好的阅读体验，请更新浏览器的版本或者使用其他现代浏览器，比如Chrome、Firefox、Safari等。</div>
<![endif]-->

<body>
  <div class="container-fluid">
    <div class="row">
      <header class="main-header"  style="background-image:url(http://7xpw2b.com1.z0.glb.clouddn.com/hexo-sinppet/img/banner2.jpg)"  >
    <div class="main-header-box">
        <a class="header-avatar" href="/" title="">
            <img src="/img/avatar.jpg" alt="logo头像">
        </a>
        <div class="branding1">
        	<!--<h2 class="text-hide">Snippet主题,从未如此简单有趣</h2>-->
            
                <h2> 记录，把握点滴  ——by 99 </h2>
            
    	</div>
    </div>
</header>

      <nav class="main-navigation">
    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                <div class="navbar-header"><span class="nav-toggle-button collapsed" data-toggle="collapse" data-target="#main-menu" id="mnav">
                    <span class="sr-only">Toggle navigation</span>
                    <i class="fa fa-bars"></i>
                    </span>
                </div>
                <div class="collapse navbar-collapse" id="main-menu">
                    <ul class="menu">
                        
                            <li role="presentation itit"><a href="/"><i class="fa fa-fw "></i>主页</a>
                            </li>
                        
                            <li role="presentation itit"><a href="/archives/"><i class="fa fa-fw "></i>所有</a>
                            </li>
                        
                            <li role="presentation itit"><a href="/posts/d16694c4/"><i class="fa fa-fw "></i>标题</a>
                            </li>
                        
                            <li role="presentation itit"><a href="/categories/ror系统/"><i class="fa fa-fw "></i>ror系统</a>
                            </li>
                        
                            <li role="presentation itit"><a href="/categories/微信小程序/"><i class="fa fa-fw "></i>微信小程序</a>
                            </li>
                        
                            <li role="presentation itit"><a href="/"><i class="fa fa-fw "></i>关于我</a>
                            </li>
                        
                    </ul>
                </div>
            </div>
        </div>
    </div>
</nav>

      <section class="content-wra aa99">
        <!-- <div class="row">
          
    <div class="widget" style="padding:0 15px;">
        <div id="search-form" > 
            <div id="result-mask" class="hide"></div>
            <div class="search-area">
                
                    <input id="search-key" type="search" autocomplete="off" placeholder="搜点什么呢?" style="width:100%;border-radius:0;">

                
                
            </div>
            <div id="result-wrap" class="hide" style="padding:0 20px;">
                <div id="search-result"></div>
            </div>
            <div class="hide">
                <template id="search-tpl">
                    <div class="item">
                        <a href="/{path}" title="{title}">
                            <div class="title">{title}</div>
                            <div class="content">{content}</div>
                        </a>
                    </div>
                </template>
            </div>
        </div>
    </div>


        </div> -->
        <div class="row">
            <main class="col-md-9 main-content m-post">
                <p id="process"></p>
<article class="post pp99">
    <div class="post-head">
        <h1 id="ror-system-rails tutorial笔记">
            
	            ror-system-rails tutorial笔记
            
        </h1>
        <div class="post-meta">
    
    
    <span class="categories-meta fa-wrap">
        <i class="fa fa-folder-open-o"></i>
        <span>ror系统</span>
    </span>
    
    
    <span class="fa-wrap">
        <i class="fa fa-tags"></i>
        <span class="tags-meta">
            
            ror系统
            
        </span>
    </span>
    
    
    <span class="fa-wrap">
        <i class="fa fa-clock-o"></i>
        <span class="date-meta">2018/01/30</span>
    </span>
</div>

            
            
    </div>
    
    <div class="post-body post-content">
        <h2 id="1-3-1"><a href="#1-3-1" class="headerlink" title="1.3.1"></a>1.3.1</h2><p>用git co替代git checkout</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git config --global alias.co checkout</span><br></pre></td></tr></table></figure>
<p>.gitignore设置，可以忽略mac finder产生的.DS_Store。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"># Ignore bundler config.</span><br><span class="line">/.bundle</span><br><span class="line"># Ignore the default SQLite database.</span><br><span class="line">/db/*.sqlite3</span><br><span class="line">/db/*.sqlite3-journal</span><br><span class="line"># Ignore all logfiles and tempfiles.</span><br><span class="line">/log/*.log</span><br><span class="line">/tmp</span><br><span class="line"># Ignore other unneeded files.</span><br><span class="line">doc/</span><br><span class="line">*.swp</span><br><span class="line">*~</span><br><span class="line">.project</span><br><span class="line">.DS_Store</span><br><span class="line">.idea</span><br></pre></td></tr></table></figure>
<h2 id="1-3-5"><a href="#1-3-5" class="headerlink" title="1.3.5"></a>1.3.5</h2><p>用git push替代git push origin master</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push --set-upstream origin master //跟踪远程分支，让本地与远程仓库关联</span><br></pre></td></tr></table></figure>
<h2 id="1-4-4"><a href="#1-4-4" class="headerlink" title="1.4.4"></a>1.4.4</h2><p>heroku命令，<a href="http://devcenter.heroku.com/heroku-command" target="_blank" rel="noopener">http://devcenter.heroku.com/heroku-command</a></p>
<p>heroku自定义域名，<a href="https://devcenter.heroku.com/" target="_blank" rel="noopener">https://devcenter.heroku.com/</a></p>
<h2 id="2-2"><a href="#2-2" class="headerlink" title="2.2"></a>2.2</h2><p>查看所有的rake命令，或查看所有的rake与db相关的m;l</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rake -T</span><br><span class="line">rake -T db</span><br></pre></td></tr></table></figure>
<h2 id="2-2-2"><a href="#2-2-2" class="headerlink" title="2.2.2"></a>2.2.2</h2><p>mvc运作流程</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">1、浏览器发出请求</span><br><span class="line">2、通过routes找到对应的controller和action</span><br><span class="line">3、controller想要通过model拿资料，比如User.all</span><br><span class="line">4、model拿到db里的资料</span><br><span class="line">5、model把拿到的资料回传给controller</span><br><span class="line">6、controller把拿到的数据赋值给@user变量，传递给view</span><br><span class="line">7、view使用ruby渲染成html</span><br><span class="line">8、controller把生成的html发送给浏览器</span><br></pre></td></tr></table></figure>
<p><img src="https://ws3.sinaimg.cn/large/006tNc79gy1fnocpw8yz2j30dj0et0sx.jpg" width="400"></p>
<h2 id="2-3-4"><a href="#2-3-4" class="headerlink" title="2.3.4"></a>2.3.4</h2><p>controller继承自ActionController::Base，能获得很多功能。</p>
<p>比如处理模型对象、过滤http请求、将视图渲染成html等。</p>
<h2 id="3-1"><a href="#3-1" class="headerlink" title="3.1"></a>3.1</h2><p>0是回到最开始的版本，数字对应不同版本。与rake db:rollback类似</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rake db:migrate VERSION=0</span><br></pre></td></tr></table></figure>
<h2 id="3-2-1-课程bug1"><a href="#3-2-1-课程bug1" class="headerlink" title="3.2.1 课程bug1"></a>3.2.1 课程bug1</h2><p>【bug】执行以下命令后报错</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bundle exec rspec spec/requests/static_pages_spec.rb</span><br></pre></td></tr></table></figure>
<p>报错如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">✘ apple@apple ⮀ ~/rails/sample_app ⮀ ⭠ test± ⮀ bundle exec rspec spec/requests/static_pages_spec.rb</span><br><span class="line">/Users/apple/.rvm/gems/ruby-2.3.1/gems/selenium-webdriver-2.0.0/lib/selenium/webdriver/common/zipper.rb:1:in `require&apos;: cannot load such file -- zip/zip (LoadError)</span><br><span class="line">	from /Users/apple/.rvm/gems/ruby-2.3.1/gems/selenium-webdriver-2.0.0/lib/selenium/webdriver/common/zipper.rb:1:in `&lt;top (required)&gt;&apos;</span><br></pre></td></tr></table></figure>
<p>解决办法：找了以下三个解答，无效。</p>
<p><a href="http://blog.csdn.net/mydo/article/details/54345527" target="_blank" rel="noopener">http://blog.csdn.net/mydo/article/details/54345527</a></p>
<p><a href="https://ruby-china.org/topics/18548" target="_blank" rel="noopener">https://ruby-china.org/topics/18548</a></p>
<p>rspect官网问答区<a href="https://github.com/rspec/rspec-rails/issues/1273" target="_blank" rel="noopener">https://github.com/rspec/rspec-rails/issues/1273</a></p>
<p>同个例子别人的blog<a href="https://hk.saowen.com/a/63a91c9dbdc6cc6e4409e590b69dbe80ce8961e5a9aec8307c6f108ad4796204" target="_blank" rel="noopener">https://hk.saowen.com/a/63a91c9dbdc6cc6e4409e590b69dbe80ce8961e5a9aec8307c6f108ad4796204</a></p>
<p>stackoverflow<a href="https://stackoverflow.com/questions/18555992/bundle-exec-rspec-spec-requests-static-pages-spec-rb-from-hartls-tutorial-isnt" target="_blank" rel="noopener">https://stackoverflow.com/questions/18555992/bundle-exec-rspec-spec-requests-static-pages-spec-rb-from-hartls-tutorial-isnt</a></p>
<p>装上gem ‘test-unit’，和gem ‘zip’，报错如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"> apple@apple ⮀ ~/rails/sample_app ⮀ ⭠ test± ⮀ bundle exec rspec spec/requests/static_pages_spec.rb</span><br><span class="line">DEPRECATION WARNING: alias_method_chain is deprecated. Please, use Module#prepend instead. From module, you can access the original method using super. (called from &lt;top (required)&gt; at /Users/apple/rails/sample_app/spec/spec_helper.rb:4)</span><br><span class="line">DEPRECATION WARNING: alias_method_chain is deprecated. Please, use Module#prepend instead. From module, you can access the original method using super. (called from &lt;top (required)&gt; at /Users/apple/rails/sample_app/spec/spec_helper.rb:4)</span><br><span class="line">/Users/apple/.rvm/gems/ruby-2.3.1/gems/rspec-rails-2.13.1/lib/rspec/rails/fixture_support.rb:19:in `block (2 levels) in &lt;module:FixtureSupport&gt;&apos;: private method `fixture_path&apos; called for #&lt;RSpec::Core::Configuration:0x007fdba70f85e0&gt; (NoMethodError)</span><br><span class="line">Did you mean?  fixture_path=</span><br><span class="line">	from /Users/apple/.rvm/gems/ruby-2.3.1/gems/rspec-rails-2.13.1/lib/rspec/rails/fixture_support.rb:17:in `class_eval&apos;</span><br></pre></td></tr></table></figure>
<h3 id="最终解决办法："><a href="#最终解决办法：" class="headerlink" title="最终解决办法："></a>最终解决办法：</h3><p>参考资料stackoverflow：<a href="https://stackoverflow.com/questions/15148585/undefined-method-visit-when-using-rspec-and-capybara-in-rails" target="_blank" rel="noopener">https://stackoverflow.com/questions/15148585/undefined-method-visit-when-using-rspec-and-capybara-in-rails</a></p>
<p>修改spec/rails_helper.rb，搞定！</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">require &apos;spec_helper&apos;</span><br><span class="line">ENV[&apos;RAILS_ENV&apos;] ||= &apos;test&apos;</span><br><span class="line">require File.expand_path(&apos;../../config/environment&apos;, __FILE__)</span><br><span class="line">abort(&quot;The Rails environment is running in production mode!&quot;) if Rails.env.production?</span><br><span class="line">require &apos;rspec/rails&apos; #加入</span><br><span class="line">require &apos;capybara/rails&apos; #加入</span><br><span class="line">require &apos;capybara/rspec&apos; #加入</span><br><span class="line"></span><br><span class="line">ActiveRecord::Migration.maintain_test_schema!</span><br><span class="line">RSpec.configure do |config|</span><br><span class="line">  config.fixture_path = &quot;#&#123;::Rails.root&#125;/spec/fixtures&quot;</span><br><span class="line">  config.infer_spec_type_from_file_location!</span><br><span class="line">  config.filter_rails_from_backtrace!</span><br><span class="line">  config.include Capybara::DSL #针对这个问题，重点加入</span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<p>生成测试文件的命令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rails g integration_test xxxx</span><br></pre></td></tr></table></figure>
<h3 id="暂时解决办法：不要按教材，代码太老了，而是按sys-自动化测试安装如下"><a href="#暂时解决办法：不要按教材，代码太老了，而是按sys-自动化测试安装如下" class="headerlink" title="暂时解决办法：不要按教材，代码太老了，而是按sys-自动化测试安装如下"></a>暂时解决办法：不要按教材，代码太老了，而是按sys-自动化测试安装如下</h3><p>gemfile</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">group :development, :test do</span><br><span class="line">  gem &apos;rspec-rails&apos;</span><br><span class="line">  gem &apos;capybara&apos;</span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<p>rails_helper.rb，把以下两行放在<code>require &#39;rspec/rails&#39;</code>之后</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">require &apos;capybara/rails&apos;</span><br><span class="line">require &apos;capybara/rspec&apos;</span><br></pre></td></tr></table></figure>
<h3 id="怎么知道gem-capybara是否生效？"><a href="#怎么知道gem-capybara是否生效？" class="headerlink" title="怎么知道gem capybara是否生效？"></a>怎么知道gem capybara是否生效？</h3><p>新建spec/features/demo.rb，用一个demo案例来测试。</p>
<p>粘贴后执行<code>rspec spec/features/demo.rb</code>，会显示1个成功0个失败。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">require &apos;rails_helper&apos; #注意是rails_helper</span><br><span class="line"></span><br><span class="line">feature &quot;demo&quot;, :type =&gt; :feature do #注意是feature</span><br><span class="line">  scenario &quot;demo1&quot; do</span><br><span class="line">    visit &quot;/&quot;</span><br><span class="line">    expect(page).to have_content(&quot;Hello&quot;)</span><br><span class="line">  end</span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<h2 id="3-2-1-课程bug2"><a href="#3-2-1-课程bug2" class="headerlink" title="3.2.1 课程bug2"></a>3.2.1 课程bug2</h2><p>教材的这段代码，因为太旧不能使用，怎么改都报错。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">require &quot;spec_helper&quot;</span><br><span class="line">describe &quot;Static pages&quot; do</span><br><span class="line">  describe &quot;Home page&quot; do</span><br><span class="line">    it &quot;should have the content &apos;Sample App&apos;&quot; do</span><br><span class="line">      visit &apos;/static_pages/home&apos;</span><br><span class="line">      expect(page).to have_content(&apos;Sample App&apos;)</span><br><span class="line">    end</span><br><span class="line">  end</span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<h3 id="解决办法："><a href="#解决办法：" class="headerlink" title="解决办法："></a>解决办法：</h3><p>把<code>spec_helper</code>改成<code>rails_helper</code>。并加上<code>:type =&gt; :feature</code>。</p>
<p>本来想用<code>:type =&gt; :request</code>，但是报错，不知道怎么解决。暂时先用feature做下去吧。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">require &apos;rails_helper&apos; #注意是rails_helper</span><br><span class="line"></span><br><span class="line">describe &quot;Static pages&quot;, :type =&gt; :feature do #注意是feature</span><br><span class="line">  describe &quot;Home page&quot; do</span><br><span class="line">    it &quot;should have the content &apos;Sample App&apos;&quot; do</span><br><span class="line">      visit &quot;/static_pages/home&quot;</span><br><span class="line">      expect(page).to have_content(&quot;Sample App&quot;)</span><br><span class="line">    end</span><br><span class="line">  end</span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<h2 id="3-2-1-课程bug3"><a href="#3-2-1-课程bug3" class="headerlink" title="3.2.1 课程bug3"></a>3.2.1 课程bug3</h2><p>不做任何操作，直接执行<code>rake db:migrate</code>报错：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"> apple@apple ⮀ ~/rails/sample_app ⮀ ⭠ master± ⮀ rake db:migrate</span><br><span class="line">rake aborted!</span><br><span class="line">NoMethodError: undefined method `last_comment&apos; for #&lt;Rake::Application:0x007fe240bed8c0&gt;</span><br></pre></td></tr></table></figure>
<p>解决办法：</p>
<p><a href="https://stackoverflow.com/questions/35893584/nomethoderror-undefined-method-last-comment-after-upgrading-to-rake-11" target="_blank" rel="noopener">https://stackoverflow.com/questions/35893584/nomethoderror-undefined-method-last-comment-after-upgrading-to-rake-11</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bundle update rspec-rails</span><br></pre></td></tr></table></figure>
<p>附：官网<a href="https://github.com/rspec/rspec-rails" target="_blank" rel="noopener">https://github.com/rspec/rspec-rails</a></p>
<h1 id="3-6这一章节是测试效率工具，结合实战圣经"><a href="#3-6这一章节是测试效率工具，结合实战圣经" class="headerlink" title="3.6这一章节是测试效率工具，结合实战圣经"></a>3.6这一章节是测试效率工具，结合实战圣经</h1><h2 id="3-6-1"><a href="#3-6-1" class="headerlink" title="3.6.1"></a>3.6.1</h2><p>rvm -v，看到已经安装，本章跳过。</p>
<h2 id="3-6-2"><a href="#3-6-2" class="headerlink" title="3.6.2"></a>3.6.2</h2><p>1、安装gem，并bundle</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">group :development, :test do</span><br><span class="line">  gem &apos;guard-rspec&apos;, &apos;2.5.0&apos;</span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<p>2、让guard结合rspec，执行：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">guard init rspec</span><br></pre></td></tr></table></figure>
<p>3、运行后，修改repec文件的代码，保存后就能在guard中看到正在自动测试。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">guard</span><br></pre></td></tr></table></figure>
<h2 id="3-6-3-课程bug，先跳过"><a href="#3-6-3-课程bug，先跳过" class="headerlink" title="3.6.3 课程bug，先跳过"></a>3.6.3 课程bug，先跳过</h2><p>安装加速gem spork-rails遇到bug，看这个gem也几年没更新了。先跳过。</p>
<h2 id="3-6-4-sublime"><a href="#3-6-4-sublime" class="headerlink" title="3.6.4 sublime"></a>3.6.4 sublime</h2><p>用快捷键执行rspec。有空回头找找atom的。</p>
<h2 id="4-3-2-ruby语法例子"><a href="#4-3-2-ruby语法例子" class="headerlink" title="4.3.2 ruby语法例子"></a>4.3.2 ruby语法例子</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(&apos;a&apos;..&apos;z&apos;).to_a.shuffle[0..7].join</span><br></pre></td></tr></table></figure>
<p>解读：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt; (&apos;a&apos;..&apos;z&apos;).to_a #      </span><br><span class="line">=&gt; [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;e&quot;, &quot;f&quot;, &quot;g&quot;, &quot;h&quot;, &quot;i&quot;, &quot;j&quot;, &quot;k&quot;, &quot;l&quot;, &quot;m&quot;, &quot;n&quot;, &quot;o&quot;, &quot;p&quot;, &quot;q&quot;, &quot;r&quot;, &quot;s&quot;, &quot;t&quot;, &quot;u&quot;, &quot;v&quot;, &quot;w&quot;, &quot;x&quot;, &quot;y&quot;, &quot;z&quot;]</span><br><span class="line">&gt;&gt; (&apos;a&apos;..&apos;z&apos;).to_a.shuffle #     </span><br><span class="line">=&gt; [&quot;c&quot;, &quot;g&quot;, &quot;l&quot;, &quot;k&quot;, &quot;h&quot;, &quot;z&quot;, &quot;s&quot;, &quot;i&quot;, &quot;n&quot;, &quot;d&quot;, &quot;y&quot;, &quot;u&quot;, &quot;t&quot;, &quot;j&quot;, &quot;q&quot;, &quot;b&quot;, &quot;r&quot;, &quot;o&quot;, &quot;f&quot;, &quot;e&quot;, &quot;w&quot;, &quot;v&quot;, &quot;m&quot;, &quot;a&quot;, &quot;x&quot;, &quot;p&quot;]</span><br><span class="line">&gt;&gt; (&apos;a&apos;..&apos;z&apos;).to_a.shuffle[0..7] #       8    </span><br><span class="line">=&gt; [&quot;f&quot;, &quot;w&quot;, &quot;i&quot;, &quot;a&quot;, &quot;h&quot;, &quot;p&quot;, &quot;c&quot;, &quot;x&quot;]</span><br><span class="line">&gt;&gt; (&apos;a&apos;..&apos;z&apos;).to_a.shuffle[0..7].join #             </span><br><span class="line">=&gt; &quot;mznpybuj&quot;</span><br></pre></td></tr></table></figure>
<h2 id="4-3-3-inspect"><a href="#4-3-3-inspect" class="headerlink" title="4.3.3 inspect"></a>4.3.3 inspect</h2><p>对比<code>puts (1..5).to_a</code>和<code>puts (1..5).to_a.inspect</code>，前者把数组作为字符串输出，后者输出数组的字面量形式。</p>
<p>inspect用法类似于p。比如<code>p :name</code>等价于<code>puts :name.inspect</code>。</p>
<h2 id="4-3-4-理解"><a href="#4-3-4-理解" class="headerlink" title="4.3.4 理解"></a>4.3.4 理解</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;%= stylesheet_link_tag &quot;application&quot;, media: &quot;all&quot;,</span><br><span class="line">                                       &quot;data-turbolinks-track&quot; =&gt; true %&gt;</span><br></pre></td></tr></table></figure>
<p>上边这段是下边这段的缩写。</p>
<ul>
<li>ruby中括号可以省略</li>
<li>hash最后一个参数，可以省略花括号</li>
<li>symbol符号不能用连字符-，所以要用旧语法<code>data-turbolinks-track&quot; =&gt; true</code></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;%= stylesheet_link_tag (&quot;application&quot;, &#123; media: &quot;all&quot;,</span><br><span class="line">                                       &quot;data-turbolinks-track&quot; =&gt; true &#125;) %&gt;</span><br></pre></td></tr></table></figure>
<p>整句解读：调用stylesheet_link_tag函数，传进两个参数，一个是字符串指明样式表路径，一个是hash包含两个元素，指明媒介类型，并启用Turbolinks功能。</p>
<h2 id="4-4-1"><a href="#4-4-1" class="headerlink" title="4.4.1"></a>4.4.1</h2><p>在类上调用的方法比如new，称为类方法。调用new得到的结果是一个对象，称为类的实例。在实例上调用的方法叫实例方法，比如length。</p>
<p>attr_accessor，相当于能够get读取、set修改。</p>
<h2 id="5-3-4-课程bug"><a href="#5-3-4-课程bug" class="headerlink" title="5.3.4 课程bug"></a>5.3.4 课程bug</h2><p>报错如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1) Static pages Home page</span><br><span class="line">   Failure/Error: it &#123; should have_title(full_title(&apos;&apos;)) &#125;</span><br><span class="line"></span><br><span class="line">   NoMethodError:</span><br><span class="line">     undefined method `full_title&apos; for #&lt;RSpec::ExampleGroups::StaticPages::HomePage:0x007fd6b8b72e60&gt;</span><br></pre></td></tr></table></figure>
<h3 id="解决办法：-1"><a href="#解决办法：-1" class="headerlink" title="解决办法："></a>解决办法：</h3><p>在spec/support/utilities.rb里定义full_tittle后，要在spec/requests/static_pages_spec.rb里引入。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">require &apos;support/utilities.rb&apos;</span><br></pre></td></tr></table></figure>
<h2 id="6-1-3"><a href="#6-1-3" class="headerlink" title="6.1.3"></a>6.1.3</h2><p>rails c沙盒，所有对数据库的修改，在exit退出后会rollback还原。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rails c --sandbox</span><br></pre></td></tr></table></figure>
<p>User.new(name:”99”)，然后save。==相当于User.create(name:”99”)。</p>
<h2 id="6-2-1"><a href="#6-2-1" class="headerlink" title="6.2.1"></a>6.2.1</h2><p>命令：创建“测试数据库”。即把开发数据库db/development.sqlite3中的数据模型复制到db/test.sqlite3测试数据库。</p>
<p>用在新建model后，rake db:migrate后执行。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rake db:migrate</span><br><span class="line">rake test:prepare</span><br></pre></td></tr></table></figure>
<h2 id="6-2-2"><a href="#6-2-2" class="headerlink" title="6.2.2"></a>6.2.2</h2><h3 id="rails-c命令"><a href="#rails-c命令" class="headerlink" title="rails c命令"></a>rails c命令</h3><p>资料验证方法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.valid?</span><br></pre></td></tr></table></figure>
<p>显示错误信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.error.full_messages</span><br></pre></td></tr></table></figure>
<h3 id="测试rspec方法"><a href="#测试rspec方法" class="headerlink" title="测试rspec方法"></a>测试rspec方法</h3><p>只要对象可以响应布尔值的方法，比如<code>foo?</code>，就有一个相应的<code>be_foo</code>可以在测试时使用。</p>
<h2 id="6-2-4"><a href="#6-2-4" class="headerlink" title="6.2.4"></a>6.2.4</h2><p>rubular，正则表达式编辑器</p>
<p><img src="https://ws4.sinaimg.cn/large/006tNc79ly1fnri1pexwyj30rh0hkaas.jpg" width="500"></p>
<h2 id="6-3-陌生"><a href="#6-3-陌生" class="headerlink" title="6.3 陌生"></a>6.3 陌生</h2><p>u.authenticate(“密码”)，密码正确会对应到这笔数据。</p>
<p>u.password_digest，密码的加密形式。</p>
<h2 id="7-1-1-指定环境env的命令"><a href="#7-1-1-指定环境env的命令" class="headerlink" title="7.1.1 指定环境env的命令"></a>7.1.1 指定环境env的命令</h2><p>1）指定进入test环境的rails c</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rails console test</span><br></pre></td></tr></table></figure>
<p>2）指定进入production生产环境的rails s</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rails server --environment production</span><br></pre></td></tr></table></figure>
<p>3）指定production生产环境的迁移migration</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rake db:migrate RAILS_ENV=production</span><br></pre></td></tr></table></figure>
<ul>
<li><p>调试。在layout/aplication.html.erb中加入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%= debug(params) if Rails.env.development? %&gt;</span><br></pre></td></tr></table></figure>
<p><img src="https://ws2.sinaimg.cn/large/006tNc79gy1fnrp764de6j30vv09awes.jpg" width="500"></p>
</li>
<li><p>@user = User.params[:id]中，params[:id]返回的是字符串比如”1”，find方法自动将其转换成整数。</p>
</li>
<li><p>gem ‘factory_girl_rails’改名成gem ‘factory_bot_rails’，不过旧的还能用。</p>
</li>
<li><p>用户头像gravator绑定邮箱用到MD5加密算法，可以在rails c测试，<code>Digest::MD5::hexdigest(email.downcase)</code>。</p>
</li>
</ul>
<h2 id="8-1"><a href="#8-1" class="headerlink" title="8.1"></a>8.1</h2><p>生成rspec测试文件authentication_pages_spec.rb</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rails generate integration_test authentication_pages</span><br></pre></td></tr></table></figure>
<h2 id="8-1-3-创建表单form-for-和-form-tag"><a href="#8-1-3-创建表单form-for-和-form-tag" class="headerlink" title="8.1.3 创建表单form_for 和 form_tag"></a>8.1.3 创建表单form_for 和 form_tag</h2><p>form_for(@user)，rails会向/users地址发送POST请求。</p>
<p>form_for(:session, url:session_path)，指明资源名称和相应的URL地址。</p>
<h2 id="8-2-1-its方法——发现不能用"><a href="#8-2-1-its方法——发现不能用" class="headerlink" title="8.2.1 its方法——发现不能用"></a>8.2.1 its方法——发现不能用</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">its(:remember_token) &#123; should_not be_blank &#125;</span><br></pre></td></tr></table></figure>
<p>its测试对象是指定的属性，而it是整个测试对象。上边代码等同于</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">it &#123; expect(@user.remember_token).not_to be_blank &#125;</span><br></pre></td></tr></table></figure>
<h2 id="8-5-练习"><a href="#8-5-练习" class="headerlink" title="8.5 练习"></a>8.5 练习</h2><p>1、什么时候用 form_for 什么时候用 form_tag ？</p>
<p>有对应 Model 的时候用 form_for，没有就用 form_tag，比如搜索框一般没有对应 Model。</p>
<h3 id="2、bug——命令rspec-spec，不能检测到执行单个文件里的bug"><a href="#2、bug——命令rspec-spec，不能检测到执行单个文件里的bug" class="headerlink" title="2、bug——命令rspec spec，不能检测到执行单个文件里的bug"></a>2、bug——命令rspec spec，不能检测到执行单个文件里的bug</h3><p>——所以，测试时修改哪个文件，就执行哪个文件的测试。</p>
<h2 id="9-1"><a href="#9-1" class="headerlink" title="9.1"></a>9.1</h2><p>rails c 里的new_record?方法。检测这笔资料是否存在于数据库中。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">User.first.new_record?</span><br></pre></td></tr></table></figure>
<h2 id="9-2-1-bug"><a href="#9-2-1-bug" class="headerlink" title="9.2.1 bug"></a>9.2.1 bug</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Failure/Error: before &#123; patch user_path(user) &#125;</span><br><span class="line">     NoMethodError:</span><br><span class="line">       undefined method `patch&apos; for #</span><br></pre></td></tr></table></figure>
<p>原因：代码<code>before { patch user_path(user) }</code>里的patch，以及其他get、put、delete，只能用在rspece的type是request的文件中。现在我用的是feature，所以报错。</p>
<p>参考资料：<a href="https://stackoverflow.com/questions/18289463/undefined-method-patch-for-rspeccore-rails-tutorial-chapter-9" target="_blank" rel="noopener">https://stackoverflow.com/questions/18289463/undefined-method-patch-for-rspeccore-rails-tutorial-chapter-9</a></p>
<h2 id="9-5-命令"><a href="#9-5-命令" class="headerlink" title="9.5 命令"></a>9.5 命令</h2><h3 id="rake"><a href="#rake" class="headerlink" title="rake"></a>rake</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rake db:reset</span><br><span class="line">rake db:populate //在lib/task的rake文件中定义的</span><br><span class="line">bin/rails db:migrate RAILS_ENV=test</span><br></pre></td></tr></table></figure>
<h3 id="heroku"><a href="#heroku" class="headerlink" title="heroku"></a>heroku</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ git push heroku</span><br><span class="line">$ heroku pg:reset DATABASE</span><br><span class="line">$ heroku rake db:migrate</span><br><span class="line">$ heroku rake db:populate</span><br><span class="line">$ heroku restart</span><br></pre></td></tr></table></figure>
<h2 id="10-1-3-课程bug"><a href="#10-1-3-课程bug" class="headerlink" title="10.1.3 课程bug"></a>10.1.3 课程bug</h2><h3 id="bug：rails-tutorial-Chapter-10-undefined-method-its’-for-RSpec"><a href="#bug：rails-tutorial-Chapter-10-undefined-method-its’-for-RSpec" class="headerlink" title="bug：rails tutorial Chapter 10  undefined method `its’ for RSpec"></a>bug：rails tutorial Chapter 10  undefined method `its’ for RSpec</h3><h3 id="解决办法：-2"><a href="#解决办法：-2" class="headerlink" title="解决办法："></a>解决办法：</h3><p>新版本的rspec不支持its语法，要安装这个gem才能使用。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gem &apos;rspec-its&apos;</span><br></pre></td></tr></table></figure>
<p>参考资料：<a href="https://stackoverflow.com/questions/28014000/undefined-method-its-for-rspec-hartls-ruby-on-rails-tutorial" target="_blank" rel="noopener">https://stackoverflow.com/questions/28014000/undefined-method-its-for-rspec-hartls-ruby-on-rails-tutorial</a></p>
<h2 id="10-1-4"><a href="#10-1-4" class="headerlink" title="10.1.4"></a>10.1.4</h2><p>User.where(1)，没有查询到会返回nil。</p>
<p>User.find_by(1)，跟where一样，没有查询到会返回nil。</p>
<p>User.find(1)，没有查询到会bug报错。类似于!方法。</p>
<h2 id="10-2-2-课程bug"><a href="#10-2-2-课程bug" class="headerlink" title="10.2.2 课程bug"></a>10.2.2 课程bug</h2><h3 id="bug-rails-tutorial-chapter10-ArgumentError-wrong-number-of-arguments-given-1-expected-0"><a href="#bug-rails-tutorial-chapter10-ArgumentError-wrong-number-of-arguments-given-1-expected-0" class="headerlink" title="bug: rails tutorial chapter10 ArgumentError: wrong number of arguments (given 1, expected 0)"></a>bug: rails tutorial chapter10 ArgumentError: wrong number of arguments (given 1, expected 0)</h3><h3 id="解决办法：-3"><a href="#解决办法：-3" class="headerlink" title="解决办法："></a>解决办法：</h3><p>打开lib/tasks/sample_data.rake，把<code>users = User.all.limit(6)</code>改成</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">users = User.limit(6)</span><br></pre></td></tr></table></figure>
<p>参考资料：<a href="https://stackoverflow.com/questions/23749612/wrong-number-of-arguments-1-for-0-hartl-chapter-10-bundle-exec-rake-dbpopul" target="_blank" rel="noopener">https://stackoverflow.com/questions/23749612/wrong-number-of-arguments-1-for-0-hartl-chapter-10-bundle-exec-rake-dbpopul</a></p>
<h2 id="10-3-2-课程bug，同上新文件要引入共用文件"><a href="#10-3-2-课程bug，同上新文件要引入共用文件" class="headerlink" title="10.3.2 课程bug，同上新文件要引入共用文件"></a>10.3.2 课程bug，同上新文件要引入共用文件</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Failure/Error: before &#123; sign_in user &#125;</span><br><span class="line"></span><br><span class="line">     NoMethodError:</span><br><span class="line">       undefined method `sign_in&apos; for #&lt;RSpec::ExampleGroups::MicropostPages::MicropostCreation::WithValidInformation:0x007fb44e1acea8&gt;</span><br></pre></td></tr></table></figure>
<h3 id="解决办法：-4"><a href="#解决办法：-4" class="headerlink" title="解决办法："></a>解决办法：</h3><p>spec/requests/micropost_pages_spec.rb</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">require &apos;support/utilities.rb&apos;</span><br></pre></td></tr></table></figure>
<h2 id="10-3-3-课程bug"><a href="#10-3-3-课程bug" class="headerlink" title="10.3.3 课程bug"></a>10.3.3 课程bug</h2><p>bug：执行<code>rspec spec/models/user_spec.rb</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">An error occurred while loading ./spec/models/user_spec.rb.</span><br><span class="line">Failure/Error: load file</span><br><span class="line"></span><br><span class="line">SyntaxError:</span><br><span class="line">  /Users/apple/rails/sys-sample_app/spec/models/user_spec.rb:138: syntax error, unexpected tIDENTIFIER, expecting keyword_end</span><br><span class="line">      its(:feed) &#123; should include(newe...</span><br><span class="line">  ...                               ^</span><br><span class="line">  /Users/apple/rails/sys-sample_app/spec/models/user_spec.rb:138: syntax error, unexpected tIDENTIFIER, expecting keyword_end</span><br><span class="line">      its(:feed) &#123; should include(olde...</span><br><span class="line">  ...                               ^</span><br><span class="line">  /Users/apple/rails/sys-sample_app/spec/models/user_spec.rb:138: syntax error, unexpected tIDENTIFIER, expecting keyword_end</span><br><span class="line">      its(:feed) &#123; should_not include(...</span><br></pre></td></tr></table></figure>
<h3 id="解决办法：-5"><a href="#解决办法：-5" class="headerlink" title="解决办法："></a>解决办法：</h3><p>把测试从以下块中移出来</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">describe &quot;micropost associations&quot; do</span><br><span class="line">  ...</span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<p>然后单独作为一个块。重新执行<code>rspec spec/models/user_spec.rb</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">describe &quot;status&quot; do</span><br><span class="line">  before &#123; @user.save &#125;</span><br><span class="line">  let!(:older_micropost) do</span><br><span class="line">    FactoryGirl.create(:micropost, user: @user, created_at: 1.day.ago)</span><br><span class="line">  end</span><br><span class="line">  let!(:newer_micropost) do</span><br><span class="line">    FactoryGirl.create(:micropost, user: @user, created_at: 1.hour.ago)</span><br><span class="line">  end</span><br><span class="line">  let(:unfollowed_post) do</span><br><span class="line">    FactoryGirl.create(:micropost, user: FactoryGirl.create(:user))</span><br><span class="line">  end</span><br><span class="line">  its(:feed) &#123; should include(newer_micropost) &#125;</span><br><span class="line">  its(:feed) &#123; should include(older_micropost) &#125;</span><br><span class="line">  its(:feed) &#123; should_not include(unfollowed_post) &#125;</span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<h2 id="11-2-5课程bug"><a href="#11-2-5课程bug" class="headerlink" title="11.2.5课程bug"></a>11.2.5课程bug</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Failures:</span><br><span class="line"></span><br><span class="line">  1) RelationshipsController creating a relationship with Ajax should increment the Relationship count</span><br><span class="line">     Failure/Error: cookies[:remember_token] = remember_token user.update_attribute(:remember_token, User.encrypt(remember_token))</span><br><span class="line"></span><br><span class="line">     NoMethodError:</span><br><span class="line">       undefined method `remember_token&apos; for #&lt;RSpec::ExampleGroups::RelationshipsController::CreatingARelationshipWithAjax:0x007f836346bcf0&gt;</span><br><span class="line">     # ./spec/support/utilities.rb:29:in `sign_in&apos;</span><br><span class="line">     # ./spec/controllers/relationships_controller_spec.rb:7:in `block (2 levels) in &lt;top (required)&gt;&apos;</span><br></pre></td></tr></table></figure>
<h3 id="原因："><a href="#原因：" class="headerlink" title="原因："></a>原因：</h3><p>跟上边的教材一样，没有require引入共用文件。</p>
<h3 id="解决办法：-6"><a href="#解决办法：-6" class="headerlink" title="解决办法："></a>解决办法：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

    </div>

    <div class="post-footer">
        <div>
            
                转载声明：商业转载请联系作者获得授权,非商业转载请注明出处 © <a href="" target="_blank">by 99</a>
            
        </div>
        <div>
            
        </div>
    </div>
</article>

<div class="article-nav prev-next-wrap clearfix">
    
    
        <a href="/posts/47bfe85d/" class="next-post btn btn-default">下一篇<i class="fa fa-angle-right fa-fw"></i></a>
    
</div>


    <div id="comments">
        
	
<div id="lv-container" data-id="city" data-uid="MTAyMC8zMzE1My85NzEx">
  <script type="text/javascript">
     (function(d, s) {
         var j, e = d.getElementsByTagName(s)[0];
         if (typeof LivereTower === 'function') { return; }
         j = d.createElement(s);
         j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
         j.async = true;
         e.parentNode.insertBefore(j, e);
     })(document, 'script');
  </script>
</div>


    </div>


            </main>
            
    <aside class="col-md-3 sidebar">
        
        
    <div class="widget">
        <h3 class="title">Search</h3>
        <div id="search-form">
            <div id="result-mask" class="hide"></div>
            <div class="search-area">
                
                    <input id="search-key" type="search" autocomplete="off" placeholder="搜点什么呢?">
                    <button type="button" class="search-form-submit" id="search-local">搜索</button>
                
                
            </div>
            <div id="result-wrap" class="hide">
                <div id="search-result"></div>
            </div>
            <div class="hide">
                <template id="search-tpl">
                    <div class="item">
                        <a href="/{path}" title="{title}">
                            <div class="title">{title}</div>
                            <div class="content">{content}</div>
                        </a>
                    </div>
                </template>
            </div>
        </div>
    </div>


        
        
    <div class="widget notification">
        <h3 class="title">网站公告</h3>
        <div>
            <p>你好，我是99。<br/>欢迎来到我的博客。<br/>
<br/>
<hr/>接受贡献，包括不限于提交问题与需求，修复代码。欢迎Pull Request<br/>支持主题：<a href="https://github.com/shenliyang/hexo-theme-snippet/stargazers">Star一下</a>
</p>
        </div>
    </div>

        
        
    <div class="widget">
      <h3 class="title">Social</h3> 
        <div class="content social">
            
	            <a href="https://github.com/jiujiubad?tab=repositories" rel="external nofollow" title="Github" target="_blank">
			    	<i class="github fa fa-github"></i>
			    </a>
            
	            <a href="jiujiubad@gmail.com" rel="external nofollow" title="邮箱" target="_blank">
			    	<i class="envelope-o fa fa-envelope-o"></i>
			    </a>
            
	            <a href="https://ws4.sinaimg.cn/large/006tNc79ly1fnvcxiavzgj30by0bymxg.jpg" rel="external nofollow" title="微信" target="_blank">
			    	<i class="weixin fa fa-weixin"></i>
			    </a>
            
        </div>
    </div>


        
        
    <div class="widget">
        <h3 class="title">Categories</h3>
        <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/ror功能/"><i class="fa" aria-hidden="true">ror功能</i></a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/ror知识点/"><i class="fa" aria-hidden="true">ror知识点</i></a><span class="category-list-count">28</span></li><li class="category-list-item"><a class="category-list-link current" href="/categories/ror系统/"><i class="fa" aria-hidden="true">ror系统</i></a><span class="category-list-count">23</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/web页面/"><i class="fa" aria-hidden="true">web页面</i></a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/工具/"><i class="fa" aria-hidden="true">工具</i></a><span class="category-list-count">23</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/微信小程序/"><i class="fa" aria-hidden="true">微信小程序</i></a><span class="category-list-count">14</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/心得/"><i class="fa" aria-hidden="true">心得</i></a><span class="category-list-count">13</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/投资/"><i class="fa" aria-hidden="true">投资</i></a><span class="category-list-count">1</span></li></ul>
    </div>


        
        
    <div class="widget">
      <h3 class="title">Archives</h3>
        <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/"><i class="fa" aria-hidden="true">January 2018</i></a><span class="archive-list-count">37</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/"><i class="fa" aria-hidden="true">December 2017</i></a><span class="archive-list-count">35</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/"><i class="fa" aria-hidden="true">November 2017</i></a><span class="archive-list-count">36</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/"><i class="fa" aria-hidden="true">September 2017</i></a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/"><i class="fa" aria-hidden="true">April 2017</i></a><span class="archive-list-count">1</span></li></ul>
    </div>


        
        
  <div class="widget">
    <h3 class="title">Tag Cloud</h3>
    <div class="content tag-cloud">
        <a href="/tags/atom/" style="font-size: 14.44px;">atom</a> <a href="/tags/bug/" style="font-size: 18.89px;">bug</a> <a href="/tags/heroku/" style="font-size: 10px;">heroku</a> <a href="/tags/hexo/" style="font-size: 12.22px;">hexo</a> <a href="/tags/interview/" style="font-size: 13.33px;">interview</a> <a href="/tags/mac/" style="font-size: 12.22px;">mac</a> <a href="/tags/orid-day/" style="font-size: 10px;">orid-day</a> <a href="/tags/orid-month/" style="font-size: 12.22px;">orid-month</a> <a href="/tags/ror功能/" style="font-size: 14.44px;">ror功能</a> <a href="/tags/ror知识点/" style="font-size: 17.78px;">ror知识点</a> <a href="/tags/ror系统/" style="font-size: 20px;">ror系统</a> <a href="/tags/stackoverflow/" style="font-size: 10px;">stackoverflow</a> <a href="/tags/typora/" style="font-size: 10px;">typora</a> <a href="/tags/vps/" style="font-size: 16.67px;">vps</a> <a href="/tags/web页面/" style="font-size: 12.22px;">web页面</a> <a href="/tags/下载/" style="font-size: 10px;">下载</a> <a href="/tags/工具/" style="font-size: 20px;">工具</a> <a href="/tags/常用/" style="font-size: 14.44px;">常用</a> <a href="/tags/微信功能/" style="font-size: 13.33px;">微信功能</a> <a href="/tags/微信系统/" style="font-size: 15.56px;">微信系统</a> <a href="/tags/微信页面/" style="font-size: 11.11px;">微信页面</a> <a href="/tags/心得/" style="font-size: 17.78px;">心得</a> <a href="/tags/手机/" style="font-size: 10px;">手机</a> <a href="/tags/投资/" style="font-size: 10px;">投资</a> <a href="/tags/搬砖/" style="font-size: 10px;">搬砖</a> <a href="/tags/核聚编程/" style="font-size: 14.44px;">核聚编程</a> <a href="/tags/科学上网/" style="font-size: 14.44px;">科学上网</a> <a href="/tags/部署/" style="font-size: 13.33px;">部署</a>
    </div>
  </div>


        
        
    <div class="widget">
        <h3 class="title">Friends</h3>
        <div class="content friends-link">
        
            <a href="http://www.shenliyang.com" class="fa" target="_blank">个人博客</a>
        
        </div>
    </div>


        
    </aside>


        </div>
      </section>
    </div>
  </div>
    <footer class="main-footer">
    <div class="container">
        <div class="row">
        </div>
    </div>
</footer>

<a id="back-to-top" class="hide">
	<i class="fa fa-chevron-up"></i>
</a>




    <div class="copyright">
    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                <span>Copyright &copy; 2018
                </span> |
                <span>
                    Powered by <a href="//hexo.io" class="copyright-links" target="_blank" rel="nofollow">Hexo</a>
                </span> |
                <span>
                    Theme by <a href="//github.com/shenliyang/hexo-theme-snippet.git" class="copyright-links" target="_blank" rel="nofollow">Snippet</a>
                </span>
            </div>
        </div>
    </div>
</div>



	<script src="/js/search.js?rev=@@hash"></script>


<script src="/js/app.js?rev=@@hash"></script>


</body>
</html>
