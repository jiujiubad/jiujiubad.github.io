<!DOCTYPE HTML>
<html>
<head>
    <!--Setting-->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta http-equiv="Cache-Control" content="no-siteapp">
    <meta name="renderer" content="webkit|ie-comp|ie-stand">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no,email=no,adress=no">
    <meta name="browsermode" content="application">
    <meta name="screen-orientation" content="portrait">
    <link rel="dns-prefetch" href="http://yoursite.com">
    <!--SEO-->



<meta name="robots" content="all" />
<meta name="google" content="all" />
<meta name="googlebot" content="all" />
<meta name="verify" content="all" />
    <!--Title-->


<title>wx-system-微信小程序开发(视频)openclub | Hexo</title>


    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">


    <link rel="icon" href="/favicon.ico">

    



<link rel="stylesheet" href="//cdn.bootcss.com/bootstrap/3.3.4/css/bootstrap.min.css?rev=3.3.4">
<link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="/css/style.css?rev=@@hash">




    
    <div class="hide">
    	<script src="https://s4.cnzz.com/z_stat.php?id=1263868967&web_id=1263868967" language="JavaScript"></script>
    </div>






    
</head>

<!--[if lte IE 8]>
<style>
    html{ font-size: 1em }
</style>
<![endif]-->
<!--[if lte IE 9]>
<div style="ie">你使用的浏览器版本过低，为了你更好的阅读体验，请更新浏览器的版本或者使用其他现代浏览器，比如Chrome、Firefox、Safari等。</div>
<![endif]-->

<body>
  <div class="container-fluid">
    <div class="row">
      <header class="main-header"  style="background-image:url(http://7xpw2b.com1.z0.glb.clouddn.com/hexo-sinppet/img/banner2.jpg)"  >
    <div class="main-header-box">
        <a class="header-avatar" href="/" title="">
            <img src="/img/avatar.jpg" alt="logo头像">
        </a>
        <div class="branding1">
        	<!--<h2 class="text-hide">Snippet主题,从未如此简单有趣</h2>-->
            
                <h2 style="color:#ddd;letter-spacing:1.5px;"> 不忘积累，记录点滴 by 99 </h2>
            
    	</div>
    </div>
</header>

      <nav class="main-navigation">
    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                <div class="navbar-header"><span class="nav-toggle-button collapsed" data-toggle="collapse" data-target="#main-menu" id="mnav">
                    <span class="sr-only">Toggle navigation</span>
                    <i class="fa fa-bars"></i>
                    </span>
                </div>
                <div class="collapse navbar-collapse" id="main-menu">
                    <ul class="menu">
                        
                            <li role="presentation itit"><a href="/"><i class="fa fa-fw "></i>Home</a>
                            </li>
                        
                            <li role="presentation itit"><a href="/posts/d16694c4/"><i class="fa fa-fw "></i>页头</a>
                            </li>
                        
                            <li role="presentation itit"><a href="/categories/ror系统/"><i class="fa fa-fw "></i>ror系统</a>
                            </li>
                        
                            <li role="presentation itit"><a href="/categories/微信小程序/"><i class="fa fa-fw "></i>微信小程序</a>
                            </li>
                        
                            <li role="presentation itit"><a href="/"><i class="fa fa-fw "></i>关于我</a>
                            </li>
                        
                    </ul>
                </div>
            </div>
        </div>
    </div>
</nav>

      <section class="content-wra aa99">
        <div class="row">
          
    <div class="widget" style="padding:0 15px;">
        <div id="search-form" >
            <div id="result-mask" class="hide"></div>
            <div class="search-area">
                
                    <input id="search-key" type="search" autocomplete="off" placeholder="搜点什么呢?" style="width:100%;border-radius:0;">

                
                
            </div>
            <div id="result-wrap" class="hide" style="padding:0 20px;">
                <div id="search-result"></div>
            </div>
            <div class="hide">
                <template id="search-tpl">
                    <div class="item">
                        <a href="/{path}" title="{title}">
                            <div class="title">{title}</div>
                            <div class="content">{content}</div>
                        </a>
                    </div>
                </template>
            </div>
        </div>
    </div>


        </div>
        <div class="row">
            <main class="col-md-9 main-content m-post">
                <p id="process"></p>
<article class="post pp99">
    <div class="post-head">
        <h1 id="wx-system-微信小程序开发(视频)openclub">
            
	            wx-system-微信小程序开发(视频)openclub
            
        </h1>
        <div class="post-meta">
    
    
    <span class="categories-meta fa-wrap">
        <i class="fa fa-folder-open-o"></i>
        <span>微信小程序</span>
    </span>
    
    
    <span class="fa-wrap">
        <i class="fa fa-tags"></i>
        <span class="tags-meta">
            
            微信系统
            
        </span>
    </span>
    
    
    <span class="fa-wrap">
        <i class="fa fa-clock-o"></i>
        <span class="date-meta">2018/01/01</span>
    </span>
</div>

            
            
    </div>
    
    <div class="post-body post-content">
        <h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><p><a href="https://www.youtube.com/playlist?list=PLXbU-2B80FvA5bNILAS8-zY3_KkE-PVn0" target="_blank" rel="noopener">openclub微信小程序开发视频</a></p>
<p><a href="https://mp.weixin.qq.com/debug/wxadoc/dev/" target="_blank" rel="noopener">微信小程序开发者文档</a></p>
<p><a href="https://github.com/ParryQiu/wxopenclub-wxapp-lessons" target="_blank" rel="noopener">小程序课程-代码</a></p>
<p>注解方法：js文件用<code>//xxx</code>，wxml文件用<code>&lt;!-- xx --&gt;</code>，wxss文件用<code>/* xx */</code></p>
<blockquote>
<p>本课程只讲解微信小程序官方文档的重点内容，细节还需要自己看。</p>
</blockquote>
<p>遗留问题</p>
<blockquote>
<p>注意事项：</p>
<p>1、admin后台不要做在小程序上，产品和分类的增加、删除、编辑不要集成在同个页面</p>
<p>2、第一次维护微信登录状态，并接入自己的用户系统会很花时间，搞不定求助</p>
<p>3、第一次做分类页面不用折腾左右联动</p>
</blockquote>
<h1 id="一、微信小程序基本概念"><a href="#一、微信小程序基本概念" class="headerlink" title="一、微信小程序基本概念"></a>一、微信小程序基本概念</h1><p>重点讲解框架、组建、API。</p>
<p>打包1M大小问题。</p>
<p>没有公司的资格，即没有AppID，可以不填直接做体验开发。</p>
<h1 id="二、tabbar的设置与相关"><a href="#二、tabbar的设置与相关" class="headerlink" title="二、tabbar的设置与相关"></a>二、tabbar的设置与相关</h1><h2 id="1、文章开头给了一个完整的测试案例"><a href="#1、文章开头给了一个完整的测试案例" class="headerlink" title="1、文章开头给了一个完整的测试案例"></a>1、文章开头给了一个完整的测试案例</h2><h2 id="2、tabbar在框架-配置下。"><a href="#2、tabbar在框架-配置下。" class="headerlink" title="2、tabbar在框架-配置下。"></a>2、tabbar在框架-配置下。</h2><p>1）找到<code>app.json</code>文件，复制文档代码。预览可以看到底部出现首页、日志两栏。</p>
<blockquote>
<p>由于屏幕适配问题，官方限制最多只能用5个tab。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&quot;tabBar&quot;: &#123;</span><br><span class="line">  &quot;list&quot;: [&#123;</span><br><span class="line">    &quot;pagePath&quot;: &quot;pages/index/index&quot;,</span><br><span class="line">    &quot;text&quot;: &quot;首页&quot;</span><br><span class="line">  &#125;, &#123;</span><br><span class="line">    &quot;pagePath&quot;: &quot;pages/logs/logs&quot;,</span><br><span class="line">    &quot;text&quot;: &quot;日志&quot;</span><br><span class="line">  &#125;]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>2）框架-配置-tabbar，找到<code>iconPath</code>、<code>selectedIconPath</code>，添加到下一段代码中</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;pagePath&quot;: &quot;pages/logs/logs&quot;,</span><br><span class="line">  &quot;text&quot;: &quot;日志&quot;,</span><br><span class="line">  &quot;iconPath&quot;: &quot;images/icon_seo.png&quot;,</span><br><span class="line">  &quot;selectedIconPath&quot;: &quot;images/icon_seo_HL.png&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>效果图如下，日志有图标，并且点击时变成高亮绿色</p>
<p><img src="https://ws3.sinaimg.cn/large/006tNc79gy1fmhaydczjdj307t0dzglt.jpg" alt="Snip20171213_5"></p>
<h2 id="3、其他配置"><a href="#3、其他配置" class="headerlink" title="3、其他配置"></a>3、其他配置</h2><p>1）网络请求时间networkTimeout模块</p>
<p>2）页头颜色和文字的配置page.json模块</p>
<h1 id="三、注册程序及程序生命周期"><a href="#三、注册程序及程序生命周期" class="headerlink" title="三、注册程序及程序生命周期"></a>三、注册程序及程序生命周期</h1><h2 id="1、讲解"><a href="#1、讲解" class="headerlink" title="1、讲解"></a>1、讲解</h2><p>1）开发-框架-逻辑层-注册程序，要了解的是生命周期的概念。onLaunch、onShow、onHide、onError、其他。</p>
<p>2）全局函数getApp()。先定义一个全局函数，然后读取全局共享的函数。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// other.js</span><br><span class="line">var appInstance = getApp()</span><br><span class="line">console.log(appInstance.globalData) // I am global data</span><br></pre></td></tr></table></figure>
<blockquote>
<p>文档的东西比较简单，主要看一下对应的代码。</p>
</blockquote>
<h2 id="2、代码"><a href="#2、代码" class="headerlink" title="2、代码"></a>2、代码</h2><p>1）<code>app.js</code>文件代码解读：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">//app.js</span><br><span class="line">App(&#123;</span><br><span class="line">  onLaunch: function () &#123;</span><br><span class="line">    // 展示本地存储能力</span><br><span class="line">    var logs = wx.getStorageSync(&apos;logs&apos;) || []</span><br><span class="line">    logs.unshift(Date.now())</span><br><span class="line">    wx.setStorageSync(&apos;logs&apos;, logs)</span><br><span class="line"></span><br><span class="line">    // 登录</span><br><span class="line">    wx.login(&#123;</span><br><span class="line">      success: res =&gt; &#123;</span><br><span class="line">        // 发送 res.code 到后台换取 openId, sessionKey, unionId</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    // 获取用户信息</span><br><span class="line">    wx.getSetting(&#123;</span><br><span class="line">      success: res =&gt; &#123;</span><br><span class="line">        if (res.authSetting[&apos;scope.userInfo&apos;]) &#123;</span><br><span class="line">          // 已经授权，可以直接调用 getUserInfo 获取头像昵称，不会弹框</span><br><span class="line">          wx.getUserInfo(&#123;</span><br><span class="line">            success: res =&gt; &#123;</span><br><span class="line">              // 可以将 res 发送给后台解码出 unionId</span><br><span class="line">              this.globalData.userInfo = res.userInfo</span><br><span class="line"></span><br><span class="line">              // 由于 getUserInfo 是网络请求，可能会在 Page.onLoad 之后才返回</span><br><span class="line">              // 所以此处加入 callback 以防止这种情况</span><br><span class="line">              if (this.userInfoReadyCallback) &#123;</span><br><span class="line">                this.userInfoReadyCallback(res)</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">  globalData: &#123;</span><br><span class="line">    userInfo: null</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<ul>
<li><code>onLaunch</code>是程序初始化时，调用<code>API</code>从本地缓存中获取数据</li>
<li>初始化后，在<code>StorageSync</code>上做一个<code>set</code></li>
<li><code>getUserInfo</code>是一个全局函数，会在其他页面被调用。这里通过微信接口获取到我当前登录用户的头像、昵称。</li>
<li>设置<code>globalData</code>在<code>onLaunch</code>的时候，就可以执行对应的动作</li>
</ul>
<p>2）加入<code>console.log(&quot;app run function: onLaunch&quot;)</code>，然后查看<code>pages/index/index.js</code>文件调用<code>apps.js</code>文件的<code>getUserInfo</code>是怎么调用的？</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">//app.js</span><br><span class="line">App(&#123;</span><br><span class="line">  onLaunch: function () &#123;</span><br><span class="line">    // 展示本地存储能力</span><br><span class="line">    var logs = wx.getStorageSync(&apos;logs&apos;) || []</span><br><span class="line">    logs.unshift(Date.now())</span><br><span class="line">    wx.setStorageSync(&apos;logs&apos;, logs)</span><br><span class="line">    console.log(&quot;app run function: onLaunch&quot;)</span><br></pre></td></tr></table></figure>
<p><img src="https://ws3.sinaimg.cn/large/006tNc79gy1fmhaybic1jj30on0gbadg.jpg" alt="Snip20171213_6"></p>
<blockquote>
<p>在初始化的时候，你可以做一些基础的动作，比如获取用户信息，比如设置好初始化的本地状态，比如把网络的图片、音频先请求好，都可以在这个生命周期进行。</p>
</blockquote>
<p>3）首先，用全局函数<code>getApp()</code>的方法，就可以去到app里面的东西。比如这里取到<code>apps.js</code>文件的<code>getUserInfo</code>。</p>
<p>4）onshow、onhide要退出和重新进入，通过微信开发者工具的<code>切后台</code>按钮切换</p>
<blockquote>
<p>预告：下节讲解页面生命周期，更复杂一点，但是大同小异。</p>
</blockquote>
<h1 id="四、页面注册及页面生命周期"><a href="#四、页面注册及页面生命周期" class="headerlink" title="四、页面注册及页面生命周期"></a>四、页面注册及页面生命周期</h1><h2 id="1、讲解-1"><a href="#1、讲解-1" class="headerlink" title="1、讲解"></a>1、讲解</h2><p>1）框架-逻辑层-注册页面，是页面生命周期的一些函数</p>
<h2 id="2、代码-1"><a href="#2、代码-1" class="headerlink" title="2、代码"></a>2、代码</h2><p>1）删除上一节添加的<code>console.log(&quot;app run function: onLaunch&quot;)</code></p>
<p>2）打开<code>pages/logs/logs.js</code>，这里onload页面加载已经有了。</p>
<p>3）增加代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">onLoad: function () &#123;</span><br><span class="line">  this.setData(&#123;</span><br><span class="line">    logs: (wx.getStorageSync(&apos;logs&apos;) || []).map(function (log) &#123;</span><br><span class="line">      return util.formatTime(new Date(log))</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;);</span><br><span class="line">  console.log(&quot;logs page execute: onLoad.&quot;);</span><br><span class="line">&#125;,  </span><br><span class="line">onReady: function() &#123;</span><br><span class="line">   // 页面已经加载完</span><br><span class="line">  console.log(&quot;logs page execute: onReady.&quot;);</span><br><span class="line">&#125;,</span><br><span class="line">onShow: function() &#123;</span><br><span class="line">  // 页面show</span><br><span class="line">  console.log(&quot;logs page execute: onShow.&quot;);</span><br><span class="line">&#125;,</span><br><span class="line">onHide: function() &#123;</span><br><span class="line">  // 页面hide</span><br><span class="line">  console.log(&quot;logs page execute: onHide.&quot;);</span><br><span class="line">&#125;,</span><br><span class="line">onUnload: function() &#123;</span><br><span class="line">  // 页面关闭时</span><br><span class="line">  console.log(&quot;logs page execute: onUnload.&quot;);</span><br><span class="line">&#125;,</span><br><span class="line">onPullDownRefresh: function() &#123;</span><br><span class="line">  // 页面下拉</span><br><span class="line">  console.log(&quot;logs page execute: onPullDownRefresh.&quot;);</span><br><span class="line">&#125;,</span><br><span class="line">onReachBottom: function() &#123;</span><br><span class="line">  // 页面触底时（可以往上拉）</span><br><span class="line">  console.log(&quot;logs page execute: onReachBottom.&quot;);</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<p>4）先清空console的内容，然后切回首页，当我们点击日志的时候，页面只执行了onshow，为什么没有执行onload、ready呢？</p>
<p>解答：跟微信的设计有关，页面加载完再来加载一次的时候，它有一个catch的机制，即onload和ready的时间就不会再执行了。</p>
<p>因此，点击编译按钮，然后清空console内容，再执行相同操作的时候，因为是第一次打开页面就会执行onload、onshow、onready事件。</p>
<p><img src="https://ws2.sinaimg.cn/large/006tNc79gy1fmhay85wgsj30iq0ihgnz.jpg" alt="Snip20171213_7"></p>
<p>5）继续下滑出现第四个事件onReachBottom。</p>
<p>6）点击切后台出现onhide，再点击切前台出现onshow。</p>
<blockquote>
<p>使用场景：用户有个短信、电话进来，或切换到微信，是不是可以保留用户订单状态，再比如游戏进度</p>
</blockquote>
<p>7）最后一个时间<strong>下拉刷新onPullDownRefresh，需要加一个配置才能生效</strong>。</p>
<p><img src="https://ws1.sinaimg.cn/large/006tNc79gy1fmhaygkadrj30ik04vq3h.jpg" alt="Snip20171213_8"></p>
<p>编辑<code>pages/logs/logs.json</code>文件，然后下拉会在console出现onPullDownRefresh事件。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;navigationBarTitleText&quot;: &quot;查看启动日志&quot;,</span><br><span class="line">    &quot;enablePullDownRefresh&quot;: true</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>使用场景：看新闻、微博、朋友圈 时下拉刷新。</p>
<p>本课程时带领大家了解框架，细节的东西还要各位仔细回去看。</p>
</blockquote>
<p>8）<code>globalData</code>和<code>setData()</code>的使用参考第三课。</p>
<p>9）生命周期图、页面路由可以看看，后面会结合真实的实例讲。</p>
<h1 id="五、模块化"><a href="#五、模块化" class="headerlink" title="五、模块化"></a>五、模块化</h1><h2 id="1、讲解-2"><a href="#1、讲解-2" class="headerlink" title="1、讲解"></a>1、讲解</h2><p>框架-逻辑层-模块化，涉及到<code>globalData</code>的使用（第三课生命周期讲过），另外是模块化的概念，把共用的函数比如js的函数封装成一些模块来开发。</p>
<p>因为这里涉及到一些ES5、ES6的语法问题，还涉及到一些<code>node_modules</code>这样一些<code>node.js</code>组件的引用。当然现在官方是支持不了node.js的，社区已经有了一些解决方案。</p>
<h2 id="2、globalData如何获取？"><a href="#2、globalData如何获取？" class="headerlink" title="2、globalData如何获取？"></a>2、globalData如何获取？</h2><blockquote>
<p>文档还要自己认真去看，包括ES6的说法（比如对平台的支持、为什么会转换）、以及一些promise的东西</p>
</blockquote>
<p>1）第四课的console.log代码可删除可以保留，我选择保留。</p>
<p>2）复习：<code>globalData</code>在<code>app.js</code>做了声明后，所有的页面都可以进行<code>globalData</code>的获取。获取的办法首先通过<code>var app = getApp();</code>这是一个全局函数，然后通过<code>app.getUserInfo</code>就能取到<code>getUserInfo</code>等内容。</p>
<p>3）</p>
<p>【问题】<code>app.js</code>里的<code>globalData: { userInfo: null }</code>，怎么在<code>index.js</code>里获取到？</p>
<p>①、index.js在开头var一个函数<code>var app = getApp();</code>、</p>
<p>在最后加入</p>
<blockquote>
<p>注意添加代码时，自己补充结尾的逗号<code>,</code>或分号<code>;</code>。否则会报错。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">onShow: function() &#123;</span><br><span class="line">  app.globalData.userInfo = &quot;wxopen.club&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>③、在log.js页面，加入<code>var app = getApp();</code>，然后在onshow事件加入<code>console.log(app.globalData.userInfo);</code></p>
<p>4）演示：点击首页，这里对globalData做了设置，然后点击日志页面，console里打印出了wxopen.club的值。</p>
<blockquote>
<p>使用场景：页面见参数的传递、全局共用的隐形参数或属性的获取与设置，都可以通过这种方式来show或者获取。</p>
</blockquote>
<h2 id="3、模块化的概念？"><a href="#3、模块化的概念？" class="headerlink" title="3、模块化的概念？"></a>3、模块化的概念？</h2><p>专案的<code>utils/util.js</code>已经给了一个方法。</p>
<p>1）在utils文件夹新建js文件Loger.js</p>
<p>2）定义function</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">function PrintLog(value) &#123;</span><br><span class="line">  console.log(&quot;Loger module: &quot; + value);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>3）</p>
<p>【问题】如何把PrintLog这个function给所有的js页面用呢 ？</p>
<p>①、（ES5、ES6中说的）通过<code>module.exports.导出的名字</code>，这里用<code>module.exports.PrintLog = PrintLog</code></p>
<p>②、如何在index.js中引用，页头加入<code>var Loger = require(&quot;../../utils/Loger.js&quot;);</code>。这种代码在logs文件夹里有参考模板。</p>
<p>③、在index.js的页尾的onShow事件里直接调用<code>Loger.PrintLog(&quot;execute index onShow&quot;);</code></p>
<blockquote>
<p>使用场景：在任何页面调用公共的方法来做一些验证，做一些资源的请求，做一些支付串的处理，做日记的格式化，都可以做成模块，在所有的js页面里使用。 </p>
</blockquote>
<h2 id="4、自己写并不强大，怎么使用nodejs的一些包呢？"><a href="#4、自己写并不强大，怎么使用nodejs的一些包呢？" class="headerlink" title="4、自己写并不强大，怎么使用nodejs的一些包呢？"></a>4、自己写并不强大，怎么使用nodejs的一些包呢？</h2><p><a href="http://www.wxopen.club/topic/582eaf2915e8801003c8c24b" target="_blank" rel="noopener">微信小程序开发三宗罪和解决办法</a></p>
<h1 id="六、数据绑定与条件渲染"><a href="#六、数据绑定与条件渲染" class="headerlink" title="六、数据绑定与条件渲染"></a>六、数据绑定与条件渲染</h1><h2 id="1、讲解-3"><a href="#1、讲解-3" class="headerlink" title="1、讲解"></a>1、讲解</h2><p>框架-视图层-WXML-数据绑定/条件渲染，绑定在一些js的模板里面，通过标签的形式绑定传过来的值（data里）。</p>
<h2 id="2、数据绑定"><a href="#2、数据绑定" class="headerlink" title="2、数据绑定"></a>2、数据绑定</h2><p>1）按github上修改index.js</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">//index.js</span><br><span class="line">//获取应用实例</span><br><span class="line">var app = getApp();</span><br><span class="line"></span><br><span class="line">Page(&#123;</span><br><span class="line">  data: &#123;</span><br><span class="line">    motto: &apos;Hello World&apos;</span><br><span class="line">  &#125;,</span><br><span class="line">  onLoad: function () &#123;</span><br><span class="line"></span><br><span class="line">  &#125;,</span><br><span class="line">  onShow: function() &#123;</span><br><span class="line">    //app.globalData.userInfo = &quot;wxopen.club&quot;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>2）修改index.wxml，下面要在view上绑定一些东西（比如这里的motto就是绑定）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--index.wxml--&gt;</span><br><span class="line">&lt;view class=&quot;container&quot;&gt;</span><br><span class="line">  &lt;view class=&quot;usermotto&quot;&gt;</span><br><span class="line">    &lt;text class=&quot;user-motto&quot;&gt;&#123;&#123;motto&#125;&#125;&lt;/text&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">&lt;/view&gt;</span><br></pre></td></tr></table></figure>
<p>3）比如在index.js的data里新增<code>userid: 1234,</code>，然后在index.wxml改成<code></code>，保存后会显示。</p>
<p><img src="https://ws2.sinaimg.cn/large/006tNc79gy1fmhayflvbqj307v072dfs.jpg" alt="Snip20171214_1"></p>
<p>4）比如文档里的“组件属性”，在text标签里加上<code>id=&quot;user-&quot;</code>。查看console的Wxml，可以看到已绑定。</p>
<p><img src="https://ws2.sinaimg.cn/large/006tNc79gy1fmhaxj96mjj30kg04mdgb.jpg" alt="Snip20171214_2"></p>
<h2 id="3、条件渲染"><a href="#3、条件渲染" class="headerlink" title="3、条件渲染"></a>3、条件渲染</h2><p>1）比如<code>wx:if</code>，在index.js的data里加入<code>show: true,</code>，然后index.wxml加入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;view wx:if=&quot;&#123;&#123;show&#125;&#125;&quot;&gt;</span><br><span class="line">  TRUE99</span><br><span class="line">&lt;/view&gt;</span><br></pre></td></tr></table></figure>
<p>当show时true的时候，就会显示<code>TRUE99</code></p>
<blockquote>
<p>使用场景：前台布局切换、样式切换。</p>
</blockquote>
<p>2）比如<code>wx:else</code>，当show不是true的时候，就显示为Bad99。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;view wx:else=&quot;&#123;&#123;show&#125;&#125;&quot;&gt;</span><br><span class="line">  Bad99</span><br><span class="line">&lt;/view&gt;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>使用场景：用户登录时显示一部分，没登录时显示另一部分。</p>
</blockquote>
<p>3）<code>hidden</code>的使用（类似if控制逻辑是否显示）：看userid是否等于1234，如果是就显示true即隐藏否则false即显示。修改index.wxml</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;view class=&quot;usermotto&quot; hidden=&quot;&#123;&#123;userid==123 ? true: false&#125;&#125;&quot;&gt;</span><br><span class="line">  &lt;text class=&quot;user-motto&quot; id=&quot;user-&#123;&#123;userid&#125;&#125;&quot;&gt;&#123;&#123;motto&#125;&#125;&lt;/text&gt;</span><br><span class="line">&lt;/view&gt;</span><br></pre></td></tr></table></figure>
<blockquote>
<p><code>hidden</code>与<code>wx:if</code>的区别？</p>
<p>解答：<code>hidden</code>组件始终会被渲染，有更高的初始渲染消耗。<code>wx:if</code>在条件成立时才渲染。</p>
<p>使用场景：需要频繁切换的情景下，用 <code>hidden</code> 更好，如果在运行时条件不大可能改变则 <code>wx:if</code> 较好。</p>
</blockquote>
<p>4）<code>block wx:if</code>，如果同时有很多个view要被控制</p>
<h1 id="七、列表渲染与模板"><a href="#七、列表渲染与模板" class="headerlink" title="七、列表渲染与模板"></a>七、列表渲染与模板</h1><h2 id="1、讲解-4"><a href="#1、讲解-4" class="headerlink" title="1、讲解"></a>1、讲解</h2><p>1）框架-视图层-WXML-列表渲染/模板，用wx:for绑定一个数组，即可使用数组中的数据。</p>
<h2 id="2、wx-for列表渲染"><a href="#2、wx-for列表渲染" class="headerlink" title="2、wx:for列表渲染"></a>2、<code>wx:for</code>列表渲染</h2><p>1）在index.js的data中加入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">data: &#123;</span><br><span class="line">  motto: &apos;Hello World&apos;,</span><br><span class="line">  userid: 1234,</span><br><span class="line">  show: false,</span><br><span class="line">  array: [&#123;</span><br><span class="line">    message: &apos;hello&apos;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    message: &apos;world&apos;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    message: &apos;!&apos;</span><br><span class="line">  &#125;],</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<p>2）index.wxml加入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;view wx:for=&quot;&#123;&#123;array&#125;&#125;&quot; wx:for-item=&quot;foritem&quot; wx:key=&quot;index&quot;&gt;</span><br><span class="line">  &lt;text id=&quot;messageIndex - &#123;&#123;index&#125;&#125;&quot;&gt;&#123;&#123;index&#125;&#125; - &#123;&#123;foritem.message&#125;&#125;&lt;/text&gt;</span><br><span class="line">&lt;/view&gt;</span><br></pre></td></tr></table></figure>
<p>①、这里的index就跟for循环的下标一样，从0开始；</p>
<p>②、利用<code>wx:key</code>加上<code>id</code>是一个比较好的习惯和实用的技巧，用于样式的控制。</p>
<blockquote>
<p>wx:key`文档有相关资料，默认建议还是写上</p>
</blockquote>
<h2 id="3、wx-key代码演示讲解"><a href="#3、wx-key代码演示讲解" class="headerlink" title="3、wx:key代码演示讲解"></a>3、<code>wx:key</code>代码演示讲解</h2><p>1）用文档提供的示例代码，修改logs.wxml</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--logs.wxml--&gt;</span><br><span class="line">&lt;view class=&quot;container log-list&quot;&gt;</span><br><span class="line">&lt;switch wx:for=&quot;&#123;&#123;objectArray&#125;&#125;&quot; wx:key=&quot;unique&quot; style=&quot;display: block;&quot;&gt; &#123;&#123;item.id&#125;&#125; &lt;/switch&gt;</span><br><span class="line">&lt;button bindtap=&quot;switch&quot;&gt; Switch &lt;/button&gt;</span><br><span class="line">&lt;button bindtap=&quot;addToFront&quot;&gt; Add to the front &lt;/button&gt;</span><br><span class="line"></span><br><span class="line">&lt;switch wx:for=&quot;&#123;&#123;numberArray&#125;&#125;&quot; wx:key=&quot;*this&quot; style=&quot;display: block;&quot;&gt; &#123;&#123;item&#125;&#125; &lt;/switch&gt;</span><br><span class="line">&lt;button bindtap=&quot;addNumberToFront&quot;&gt; Add to the front &lt;/button&gt;</span><br><span class="line">&lt;/view&gt;</span><br></pre></td></tr></table></figure>
<p>2）用文档提供的page代码，替换logs.js的page</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">Page(&#123;</span><br><span class="line">  data: &#123;</span><br><span class="line">    objectArray: [</span><br><span class="line">      &#123;id: 5, unique: &apos;unique_5&apos;&#125;,</span><br><span class="line">      &#123;id: 4, unique: &apos;unique_4&apos;&#125;,</span><br><span class="line">      &#123;id: 3, unique: &apos;unique_3&apos;&#125;,</span><br><span class="line">      &#123;id: 2, unique: &apos;unique_2&apos;&#125;,</span><br><span class="line">      &#123;id: 1, unique: &apos;unique_1&apos;&#125;,</span><br><span class="line">      &#123;id: 0, unique: &apos;unique_0&apos;&#125;,</span><br><span class="line">    ],</span><br><span class="line">    numberArray: [1, 2, 3, 4]</span><br><span class="line">  &#125;,</span><br><span class="line">  switch: function(e) &#123;</span><br><span class="line">    const length = this.data.objectArray.length</span><br><span class="line">    for (let i = 0; i &lt; length; ++i) &#123;</span><br><span class="line">      const x = Math.floor(Math.random() * length)</span><br><span class="line">      const y = Math.floor(Math.random() * length)</span><br><span class="line">      const temp = this.data.objectArray[x]</span><br><span class="line">      this.data.objectArray[x] = this.data.objectArray[y]</span><br><span class="line">      this.data.objectArray[y] = temp</span><br><span class="line">    &#125;</span><br><span class="line">    this.setData(&#123;</span><br><span class="line">      objectArray: this.data.objectArray</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">  addToFront: function(e) &#123;</span><br><span class="line">    const length = this.data.objectArray.length</span><br><span class="line">    this.data.objectArray = [&#123;id: length, unique: &apos;unique_&apos; + length&#125;].concat(this.data.objectArray)</span><br><span class="line">    this.setData(&#123;</span><br><span class="line">      objectArray: this.data.objectArray</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">  addNumberToFront: function(e)&#123;</span><br><span class="line">    this.data.numberArray = [ this.data.numberArray.length + 1 ].concat(this.data.numberArray)</span><br><span class="line">    this.setData(&#123;</span><br><span class="line">      numberArray: this.data.numberArray</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>3）切换到日志页面，可以看到显示。</p>
<ul>
<li>switch按钮，用来做随机顺序；</li>
<li>Add to the front按钮，保留刚刚的顺序，在头部加入数字</li>
</ul>
<h2 id="4、模板template"><a href="#4、模板template" class="headerlink" title="4、模板template"></a>4、模板template</h2><p>1）index.wxml加入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;template is=&quot;msgItem&quot; data=&quot;&#123;&#123;...item&#125;&#125;&quot;/&gt;</span><br><span class="line">&lt;template is=&quot;msgItem&quot; data=&quot;&#123;&#123;...itemb&#125;&#125;&quot;/&gt;</span><br><span class="line"></span><br><span class="line">&lt;template name=&quot;msgItem&quot;&gt;</span><br><span class="line">  &lt;view&gt;</span><br><span class="line">    &lt;text&gt; &#123;&#123;index&#125;&#125;: &#123;&#123;msg&#125;&#125; &lt;/text&gt;</span><br><span class="line">    &lt;text&gt; Time: &#123;&#123;time&#125;&#125; &lt;/text&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>
<p>2）index.js加入（注意另外补充前边逗号，否则报错）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">item: &#123;</span><br><span class="line">  index: 0,</span><br><span class="line">  msg: &apos;this is a template&apos;,</span><br><span class="line">  time: &apos;2016-09-15&apos;</span><br><span class="line">&#125;,</span><br><span class="line">itemb: &#123;</span><br><span class="line">  index: 99,</span><br><span class="line">  msg: &apos;this is 99&apos;,</span><br><span class="line">  time: &apos;2099-99-9&apos;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这样就可以把data里不同的item参数值传到同一个template，用<code>&lt;template is=&quot;msgItem&quot; data=&quot;...&quot;/&gt;</code>调用。</p>
<p><img src="https://ws2.sinaimg.cn/large/006tNc79gy1fmhayetj2hj30sa0533zp.jpg" alt="Snip20171214_3"></p>
<blockquote>
<p>使用场景：展示一行一行样式一样的新闻。</p>
</blockquote>
<h1 id="八、事件"><a href="#八、事件" class="headerlink" title="八、事件"></a>八、事件</h1><p>框架-视图层-WXML-事件</p>
<h2 id="1、代码"><a href="#1、代码" class="headerlink" title="1、代码"></a>1、代码</h2><p>1）index.wxml改成</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--index.wxml--&gt;</span><br><span class="line">&lt;view class=&quot;container&quot;&gt;</span><br><span class="line">  &lt;view class=&quot;usermotto&quot;&gt;</span><br><span class="line">    &lt;text class=&quot;user-motto&quot; id=&quot;user-&#123;&#123;userid&#125;&#125;&quot;&gt;&#123;&#123;motto&#125;&#125;&#123;&#123;userid&#125;&#125;&lt;/text&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">&lt;/view&gt;</span><br></pre></td></tr></table></figure>
<p>index.js改成</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">//index.js</span><br><span class="line">//获取应用实例</span><br><span class="line">var app = getApp();</span><br><span class="line"></span><br><span class="line">Page(&#123;</span><br><span class="line">  data: &#123;</span><br><span class="line">    motto: &apos;Hello World&apos;,</span><br><span class="line">    userid: 1234,</span><br><span class="line">  &#125;,</span><br><span class="line">  onLoad: function () &#123;</span><br><span class="line"></span><br><span class="line">  &#125;,</span><br><span class="line">  onShow: function() &#123;</span><br><span class="line">    //app.globalData.userInfo = &quot;wxopen.club&quot;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>2）用<code>bindtap=&quot;tapName&quot;</code>绑定手机点击的事件。</p>
<p>比如index.wxml加入<code>&lt;view class=&quot;usermotto&quot; bindtap=&quot;tapMessage&quot;&gt;</code></p>
<p>3）index.js加入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tapMessage: function (event) &#123;</span><br><span class="line">  console.log(event);</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<p><img src="https://ws2.sinaimg.cn/large/006tNc79gy1fmhayakcldj30mq0biabf.jpg" alt="Snip20171214_4"></p>
<ul>
<li>currentTarget，里面可以传一些参数进来，里面的dataset。id也可以传进来。</li>
<li>detail坐标</li>
<li>touches的坐标，获取整个页面大小</li>
<li>type，当前事件类型</li>
</ul>
<h2 id="2、其他用法"><a href="#2、其他用法" class="headerlink" title="2、其他用法"></a>2、其他用法</h2><p>1）前台可以传一些参数进入事件里。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">。。。。。。代码演示</span><br></pre></td></tr></table></figure>
<p>2）大小写的问题</p>
<p>3）事件冒泡问题（点击里层会往外冒出到第一层），如何阻止？</p>
<p>解答：用<code>catchtap</code>，比如<code>&lt;view id=&quot;middle&quot; catchtap=&quot;handleTap2&quot;&gt;</code></p>
<h1 id="九、引用"><a href="#九、引用" class="headerlink" title="九、引用"></a>九、引用</h1><p>框架-视图层-WXML-引用</p>
<h2 id="1、新建目录pages-common，新建文件template-item-wxml"><a href="#1、新建目录pages-common，新建文件template-item-wxml" class="headerlink" title="1、新建目录pages/common，新建文件template_item.wxml"></a>1、新建目录pages/common，新建文件template_item.wxml</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;template name=&quot;item&quot;&gt;</span><br><span class="line">&lt;text&gt;template text: &#123;&#123;text&#125;&#125;&lt;/text&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>
<h2 id="2、如何在index-wxml里进行定义和传参数呢？"><a href="#2、如何在index-wxml里进行定义和传参数呢？" class="headerlink" title="2、如何在index.wxml里进行定义和传参数呢？"></a>2、如何在index.wxml里进行定义和传参数呢？</h2><h3 id="2-1、import语法（实现模板的加载拼接，即第七课模板内容的跨文件拼接）"><a href="#2-1、import语法（实现模板的加载拼接，即第七课模板内容的跨文件拼接）" class="headerlink" title="2.1、import语法（实现模板的加载拼接，即第七课模板内容的跨文件拼接）"></a>2.1、import语法（实现模板的加载拼接，即第七课模板内容的跨文件拼接）</h3><p>1）在index.wxml加入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;import src=&quot;../common/template_item.wxml&quot;/&gt;</span><br><span class="line">...</span><br><span class="line">&lt;template is=&quot;item&quot; data=&quot;&#123;&#123;text: &apos;index page trans data&apos;&#125;&#125;&quot;/&gt;</span><br></pre></td></tr></table></figure>
<p><img src="https://ws2.sinaimg.cn/large/006tNc79gy1fmhaye14ayj30vq09mgn8.jpg" alt="Snip20171214_5"></p>
<h3 id="2-2、include语法（实现navbar、footer的拆分）"><a href="#2-2、include语法（实现navbar、footer的拆分）" class="headerlink" title="2.2、include语法（实现navbar、footer的拆分）"></a>2.2、include语法（实现navbar、footer的拆分）</h3><p>1）新建common/header.wxml，加入<code>&lt;text&gt;HEADER&lt;/text&gt;</code></p>
<p>2）新建common/footer.wxml，加入<code>&lt;text&gt;FOOTER&lt;/text&gt;</code></p>
<p>3）index.wxml加入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;include src=&quot;../common/header.wxml&quot;/&gt;</span><br><span class="line">...</span><br><span class="line">&lt;include src=&quot;../common/footer.wxml&quot;/&gt;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>使用场景：1、页头页脚。2、新闻模块右边栏相关消息或推荐新闻，当不需要传参的时候用include，当需要传参的时候用template。</p>
</blockquote>
<h1 id="十、样式（和css差不多）"><a href="#十、样式（和css差不多）" class="headerlink" title="十、样式（和css差不多）"></a>十、样式（和css差不多）</h1><p>框架-视图层-WXSS，单个页面的定义优先于全局样式app.wxss。</p>
<h2 id="1、常规样式"><a href="#1、常规样式" class="headerlink" title="1、常规样式"></a>1、常规样式</h2><p>1）文档里提供的选择器.class、id、element（如view组件）、element, element、::after、::before。</p>
<p>2）内联样式</p>
<ul>
<li><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;view style=&quot;color:&#123;&#123;color&#125;&#125;;&quot; /&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>style 接收动态的样式，在运行时会进行解析，请尽量避免将静态的样式写进 style 中，以免影响渲染速度。</li>
</ul>
</li>
<li><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;view class=&quot;normal_view&quot; /&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>类选择器名(样式类名)的集合，样式类名不需要带上<code>.</code>，样式类名之间用空格分隔。</li>
</ul>
</li>
</ul>
<p>3）样式导入比如<code>@import &quot;common.wxss&quot;;</code></p>
<h2 id="2、wx响应式样式"><a href="#2、wx响应式样式" class="headerlink" title="2、wx响应式样式"></a>2、wx响应式样式</h2><p>1）rpx，即响应式px。大小屏幕总宽等分为750rpx。</p>
<ul>
<li>换算方法：在iphone6（屏幕宽度375px）上，1rpx=0.5px</li>
</ul>
<p>2）rem，大小屏幕宽度等分为为20rem。</p>
<ul>
<li>换算方法：1rem=(750/20)rpx</li>
</ul>
<h1 id="十一、API网络请求与列表绑定"><a href="#十一、API网络请求与列表绑定" class="headerlink" title="十一、API网络请求与列表绑定"></a>十一、API网络请求与列表绑定</h1><p>知识点1：API网络请求</p>
<p>知识点2：复习第六章数据绑定、第七章列表渲染wx:for，把API网络请求绑定到列表</p>
<p>其他知识：button、image组件的使用</p>
<h2 id="1、准备工作"><a href="#1、准备工作" class="headerlink" title="1、准备工作"></a>1、准备工作</h2><p>1）index.js改为</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">//index.js</span><br><span class="line">//获取应用实例</span><br><span class="line">var app = getApp();</span><br><span class="line">Page(&#123;</span><br><span class="line">  data: &#123;</span><br><span class="line"></span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>index.wxml前台页面改为</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--index.wxml--&gt;</span><br><span class="line">&lt;view class=&quot;container&quot;&gt;</span><br><span class="line"></span><br><span class="line">&lt;/view&gt;</span><br></pre></td></tr></table></figure>
<p>index.wxss改为</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/**index.wxss**/</span><br></pre></td></tr></table></figure>
<p>app.wxss保持</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">/**app.wxss**/</span><br><span class="line">.container &#123;</span><br><span class="line">  height: 100%;</span><br><span class="line">  display: flex;</span><br><span class="line">  flex-direction: column;</span><br><span class="line">  align-items: center;</span><br><span class="line">  justify-content: space-between;</span><br><span class="line">  padding: 200rpx 0;</span><br><span class="line">  box-sizing: border-box;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="2、网络请求"><a href="#2、网络请求" class="headerlink" title="2、网络请求"></a>2、网络请求</h2><p>打开文档-API-发起请求</p>
<p><a href="http://newsapi.gugujiankong.com/Handler.ashx?action=getnews&amp;type=top&amp;count=10" target="_blank" rel="noopener">课程提供的API接口网址</a></p>
<h3 id="2-1-讲解"><a href="#2-1-讲解" class="headerlink" title="2.1 讲解"></a>2.1 讲解</h3><p>1）发起网络请求如下。比较简单，直接把示例代码拷过来用。</p>
<p>①、url，参数</p>
<p>②、data，请求参数，也可以拼接在url里</p>
<p>③、header，注意不能设置Referer因为只是请求api，Referer没有意义</p>
<p>④、method，基本继承了http的方法如GET、POST、PUT、DELETE等</p>
<p>⑤、success、fail、complete，做回调</p>
<p>2）Bug &amp; Tip，当前版本的问题。</p>
<p>①、上线版本一定要注意转换为TTPS，然后部署TLS的版本要注意一下。</p>
<p>②、url中不能有端口（可能是要做一些域名的备案验证）。</p>
<h3 id="2-2-代码"><a href="#2-2-代码" class="headerlink" title="2.2 代码"></a>2.2 代码</h3><p>1）index.wxml加入按钮，设置点击loadData</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--index.wxml--&gt;</span><br><span class="line">&lt;view class=&quot;container&quot; wx:key=&quot;index&quot;&gt;</span><br><span class="line">  &lt;view&gt;</span><br><span class="line">    &lt;button type=&quot;primary&quot; bindtap=&quot;loadData&quot;&gt;加载数据&lt;/button&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">&lt;/view&gt;</span><br></pre></td></tr></table></figure>
<p>2）index.js，加一个function，把API示例代码贴过去。并粘贴api接口网址。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">loadData: function () &#123;</span><br><span class="line">  wx.request(&#123;</span><br><span class="line">    url: &apos;http://newsapi.gugujiankong.com/Handler.ashx?action=getnews&amp;type=top&amp;count=10&apos;, //仅为示例，并非真实的接口地址</span><br><span class="line">    header: &#123;</span><br><span class="line">      &apos;content-type&apos;: &apos;application/json&apos; // 默认值</span><br><span class="line">    &#125;,</span><br><span class="line">    success: function (res) &#123;</span><br><span class="line">      console.log(res.data)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>当点击按钮的时候就会请求，然后在console里把请求的代码打印出来。</p>
<p><img src="https://ws1.sinaimg.cn/large/006tNc79gy1fmhaya49lxj30kd05ojta.jpg" alt="Snip20171214_6"></p>
<h2 id="3、把API请求绑定到列表"><a href="#3、把API请求绑定到列表" class="headerlink" title="3、把API请求绑定到列表"></a>3、把API请求绑定到列表</h2><p>调整按钮位置。修改app.wxss，<code>padding: 0 0rpx;</code></p>
<p>1）index.wxml加入如下，用来绑定新闻图片、类型、标题。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;view wx:for=&quot;&#123;&#123;newsdata&#125;&#125;&quot;&gt;</span><br><span class="line">  &lt;image sytle=&quot;width:300px;height:200px;&quot; src=&quot;&#123;&#123;item.thumbnail_pic_s&#125;&#125;&quot;&gt;&lt;/image&gt;</span><br><span class="line">  [&#123;&#123;item.realtype&#125;&#125;]&#123;&#123;item.title&#125;&#125;</span><br><span class="line">&lt;/view&gt;</span><br></pre></td></tr></table></figure>
<p>2）index.js的data里定义上边写<code>newsdata: &#39;&#39;</code></p>
<p>3）这里的this肯定会指向不明，所以在<code>loadData: function(){}</code>刚开始的时候对this做存储，即<code>var that = this;</code>用转移的形式把它变成that</p>
<p>4）在success的function里加入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">that.setData(&#123;</span><br><span class="line">  newsdata: res.data</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p><strong>最后的index.js代码如下：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">//index.js</span><br><span class="line">//获取应用实例</span><br><span class="line">var app = getApp();</span><br><span class="line">Page(&#123;</span><br><span class="line">  data: &#123;</span><br><span class="line">    newsdata: &apos;&apos;</span><br><span class="line">  &#125;,</span><br><span class="line">  loadData: function () &#123;</span><br><span class="line">    var that = this;</span><br><span class="line">    wx.request(&#123;</span><br><span class="line">      url: &apos;http://newsapi.gugujiankong.com/Handler.ashx?action=getnews&amp;type=top&amp;count=10&apos;, //仅为示例，并非真实的接口地址</span><br><span class="line">      header: &#123;</span><br><span class="line">        &apos;content-type&apos;: &apos;application/json&apos;</span><br><span class="line">      &#125;,</span><br><span class="line">      success: function (res) &#123;</span><br><span class="line">        console.log(res.data)</span><br><span class="line">        that.setData(&#123;</span><br><span class="line">          newsdata: res.data</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>点击按钮，会加载出图片</p>
<p><img src="https://ws1.sinaimg.cn/large/006tNc79gy1fmhaybxew6j307w0dv3zj.jpg" alt="Snip20171214_7"></p>
<blockquote>
<p>把API请求绑定到列表的思路：</p>
<p>①、设置data参数newsdata用于调用：在index.js的data里定义数组newsdata</p>
<p>②、在index.wxml中用wx:for=”“绑定数组。绑定数组后可以用调用数据，所以定义<code></code>、<code></code>、<code></code>分别调用API里的图片、类型、标题。</p>
<p>③、在生命周期success里，定义this.setData({})用于改变页面信息。这里是把newsdata的值由空变为res.data，即传进来的API参数。于是定义的数组便有了值，通过显示出来。</p>
</blockquote>
<h1 id="十二、项目一-1-准备工作"><a href="#十二、项目一-1-准备工作" class="headerlink" title="十二、项目一(1)准备工作"></a>十二、项目一(1)准备工作</h1><p>咕咕监控，做它微信小程序的版本（小程序适用于使用频次不太多，但想起来的时候能用的产品）。</p>
<p>1）index.js改成</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">//index.js</span><br><span class="line">//获取应用实例</span><br><span class="line">var app = getApp();</span><br><span class="line">Page(&#123;</span><br><span class="line">  data: &#123;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>2）index.wxml改成</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--index.wxml--&gt;</span><br><span class="line">&lt;view class=&quot;container&quot;&gt;</span><br><span class="line"></span><br><span class="line">&lt;/view&gt;</span><br></pre></td></tr></table></figure>
<p>3）logs目录重命名为usercenter，四个文件名都改成login.xx</p>
<p>login.wxml改成</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;view class=&quot;page&quot;&gt;</span><br><span class="line"></span><br><span class="line">&lt;/view&gt;</span><br></pre></td></tr></table></figure>
<p>login.js改成</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Page(&#123;</span><br><span class="line">  data: &#123;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>login.json改成</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;navigationBarTitleText&quot;: &quot;用户中心&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>4）在app.json里首尾的两个<code>pages/logs/logs</code>改成<code>pages/usercenter/login</code>；</p>
<p>把页头的“WeChat”改成“咕咕监控”</p>
<p>把“日志”改成“用户中心”；</p>
<p>把图标<code>images/icon_seo.png</code>改成<code>images/icon_account.png</code>；</p>
<p>把图标<code>images/icon_seo_HL.png</code>改成<code>images/icon_account_HL.png</code>；</p>
<p>图标文件放到images文件夹。</p>
<p>5）app.wxss改成</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br></pre></td><td class="code"><pre><span class="line">.container &#123;</span><br><span class="line">  display: flex;</span><br><span class="line">  flex-direction: column;</span><br><span class="line">  min-height: 100%;</span><br><span class="line">  justify-content: space-between;</span><br><span class="line">&#125;</span><br><span class="line">.page-header &#123;</span><br><span class="line">  font-size: 32px;</span><br><span class="line">  color: #aaa;</span><br><span class="line">  margin-top: 50rpx;</span><br><span class="line">  flex-direction: column;</span><br><span class="line">  align-items: center;</span><br><span class="line">&#125;</span><br><span class="line">.page-header-text &#123;</span><br><span class="line">  padding: 20rpx 40rpx;</span><br><span class="line">&#125;</span><br><span class="line">.page-header-line &#123;</span><br><span class="line">  width: 150rpx;</span><br><span class="line">  height: 1px;</span><br><span class="line">  border-bottom: 1px solid #ccc;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.page-body &#123;</span><br><span class="line">  width: 100%;</span><br><span class="line">  display: flex;</span><br><span class="line">  flex-direction: column;</span><br><span class="line">  align-items: center;</span><br><span class="line">  flex-grow: 1;</span><br><span class="line">  overflow-x: hidden;</span><br><span class="line">&#125;</span><br><span class="line">.page-body-wrapper &#123;</span><br><span class="line">  margin-top: 100rpx;</span><br><span class="line">  display: flex;</span><br><span class="line">  flex-direction: column;</span><br><span class="line">  align-items: center;</span><br><span class="line">  width: 100%;</span><br><span class="line">&#125;</span><br><span class="line">.page-body-wrapper form &#123;</span><br><span class="line">  width: 100%;</span><br><span class="line">&#125;</span><br><span class="line">.page-body-wording &#123;</span><br><span class="line">  text-align: center;</span><br><span class="line">  padding: 200rpx 100rpx;</span><br><span class="line">&#125;</span><br><span class="line">.page-body-info &#123;</span><br><span class="line">  display: flex;</span><br><span class="line">  flex-direction: column;</span><br><span class="line">  align-items: center;</span><br><span class="line">  background-color: #fff;</span><br><span class="line">  margin-bottom: 50rpx;</span><br><span class="line">  width: 100%;</span><br><span class="line">  padding: 50rpx 0 150rpx 0;</span><br><span class="line">&#125;</span><br><span class="line">.page-body-title &#123;</span><br><span class="line">  margin-bottom: 100rpx;</span><br><span class="line">  font-size: 32rpx;</span><br><span class="line">&#125;</span><br><span class="line">.page-body-text &#123;</span><br><span class="line">  font-size: 30rpx;</span><br><span class="line">  line-height: 26px;</span><br><span class="line">  color: #ccc;</span><br><span class="line">&#125;</span><br><span class="line">.page-body-text-small &#123;</span><br><span class="line">  font-size: 24rpx;</span><br><span class="line">  color: #000;</span><br><span class="line">  margin-bottom: 100rpx;</span><br><span class="line">&#125;</span><br><span class="line">.page-body-form &#123;</span><br><span class="line">  width: 100%;</span><br><span class="line">  background-color: #fff;</span><br><span class="line">  display: flex;</span><br><span class="line">  flex-direction: column;</span><br><span class="line">  width: 100%;</span><br><span class="line">  border: 1px solid #eee;</span><br><span class="line">&#125;</span><br><span class="line">.page-body-form-item &#123;</span><br><span class="line">  display: flex;</span><br><span class="line">  align-items: center;</span><br><span class="line">  margin-left: 30rpx;</span><br><span class="line">  border-bottom: 1px solid #eee;</span><br><span class="line">  height: 88rpx;</span><br><span class="line">  font-size: 34rpx;</span><br><span class="line">&#125;</span><br><span class="line">.page-body-form-key &#123;</span><br><span class="line">  width: 180rpx;</span><br><span class="line">  color: #000;</span><br><span class="line">&#125;</span><br><span class="line">.page-body-form-value &#123;</span><br><span class="line">  flex-grow: 1;</span><br><span class="line">&#125;</span><br><span class="line">.page-body-form-value .input-placeholder &#123;</span><br><span class="line">  color: #b2b2b2;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.page-body-form-picker &#123;</span><br><span class="line">  display: flex;</span><br><span class="line">  justify-content: space-between;</span><br><span class="line">  height: 100rpx;</span><br><span class="line">  align-items: center;</span><br><span class="line">  font-size: 36rpx;</span><br><span class="line">  margin-left: 20rpx;</span><br><span class="line">  padding-right: 20rpx;</span><br><span class="line">  border-bottom: 1px solid #eee;</span><br><span class="line">&#125;</span><br><span class="line">.page-body-form-picker-value &#123;</span><br><span class="line">  color: #ccc;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.page-body-buttons &#123;</span><br><span class="line">  width: 100%;</span><br><span class="line">&#125;</span><br><span class="line">.page-body-button &#123;</span><br><span class="line">  margin: 25rpx;</span><br><span class="line">&#125;</span><br><span class="line">.page-body-button image &#123;</span><br><span class="line">  width: 150rpx;</span><br><span class="line">  height: 150rpx;</span><br><span class="line">&#125;</span><br><span class="line">.page-footer &#123;</span><br><span class="line">  text-align: center;</span><br><span class="line">  color: #1aad19;</span><br><span class="line">  font-size: 24rpx;</span><br><span class="line">  margin: 20rpx 0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.green&#123;</span><br><span class="line">    color: #09BB07;</span><br><span class="line">&#125;</span><br><span class="line">.red&#123;</span><br><span class="line">    color: #F76260;</span><br><span class="line">&#125;</span><br><span class="line">.blue&#123;</span><br><span class="line">    color: #10AEFF;</span><br><span class="line">&#125;</span><br><span class="line">.yellow&#123;</span><br><span class="line">    color: #FFBE00;</span><br><span class="line">&#125;</span><br><span class="line">.gray&#123;</span><br><span class="line">    color: #C9C9C9;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.strong&#123;</span><br><span class="line">    font-weight: bold;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.bc_green&#123;</span><br><span class="line">    background-color: #09BB07;</span><br><span class="line">&#125;</span><br><span class="line">.bc_red&#123;</span><br><span class="line">    background-color: #F76260;</span><br><span class="line">&#125;</span><br><span class="line">.bc_blue&#123;</span><br><span class="line">    background-color: #10AEFF;</span><br><span class="line">&#125;</span><br><span class="line">.bc_yellow&#123;</span><br><span class="line">    background-color: #FFBE00;</span><br><span class="line">&#125;</span><br><span class="line">.bc_gray&#123;</span><br><span class="line">    background-color: #C9C9C9;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.tc&#123;</span><br><span class="line">    text-align: center;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.page input&#123;</span><br><span class="line">    padding: 20rpx 30rpx;</span><br><span class="line">    background-color: #fff;</span><br><span class="line">    border-bottom: 1px solid #dddddd;</span><br><span class="line">&#125;</span><br><span class="line">checkbox, radio&#123;</span><br><span class="line">    margin-right: 10rpx;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.btn-area&#123;</span><br><span class="line">    padding: 0 30px;</span><br><span class="line">&#125;</span><br><span class="line">.btn-area button&#123;</span><br><span class="line">    margin-top: 20rpx;</span><br><span class="line">    margin-bottom: 20rpx;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.page &#123;</span><br><span class="line">    min-height: 100%;</span><br><span class="line">    flex: 1;</span><br><span class="line">    font-size: 32rpx;</span><br><span class="line">    font-family: -apple-system-font,Helvetica Neue,Helvetica,sans-serif;</span><br><span class="line">    overflow: hidden;</span><br><span class="line">&#125;</span><br><span class="line">.page__hd&#123;</span><br><span class="line">    padding: 50rpx 50rpx 50rpx 50rpx;</span><br><span class="line">    text-align: center;</span><br><span class="line">&#125;</span><br><span class="line">.page__title&#123;</span><br><span class="line">    display: inline-block;</span><br><span class="line">    padding: 20rpx 40rpx;</span><br><span class="line">    font-size: 32rpx;</span><br><span class="line">    color: #AAAAAA;</span><br><span class="line">    border-bottom: 1px solid #CCCCCC;</span><br><span class="line">&#125;</span><br><span class="line">.page__desc&#123;</span><br><span class="line">    display: none;</span><br><span class="line">    margin-top: 20rpx;</span><br><span class="line">    font-size: 26rpx;</span><br><span class="line">    color: #BBBBBB;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.section&#123;</span><br><span class="line">    margin-bottom: 30rpx;</span><br><span class="line">&#125;</span><br><span class="line">.section_gap&#123;</span><br><span class="line">    padding: 0 30rpx;</span><br><span class="line">&#125;</span><br><span class="line">.section__title&#123;</span><br><span class="line">    margin-bottom: 16rpx;</span><br><span class="line">    padding-left: 30rpx;</span><br><span class="line">    padding-right: 30rpx;</span><br><span class="line">&#125;</span><br><span class="line">.section_gap .section__title&#123;</span><br><span class="line">    padding-left: 0;</span><br><span class="line">    padding-right: 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="十三、项目一-2-对用户中心做布局"><a href="#十三、项目一-2-对用户中心做布局" class="headerlink" title="十三、项目一(2)对用户中心做布局"></a>十三、项目一(2)对用户中心做布局</h1><p>1）login.wxml改为</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--logs.wxml--&gt;</span><br><span class="line">&lt;view class=&quot;page&quot;&gt;</span><br><span class="line">    &lt;view class=&quot;page__hd&quot;&gt;</span><br><span class="line">        &lt;view class=&quot;section__ctn&quot;&gt;</span><br><span class="line">            &lt;Image style=&quot;width:100px; height:100px;&quot; src=&quot;https://o97mkvfjm.qnssl.com/logo.png&quot;&gt;&lt;/Image&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">    &lt;view class=&quot;page__bd&quot;&gt;</span><br><span class="line">      &lt;view class=&quot;section&quot;&gt;</span><br><span class="line">        &lt;input type=&quot;text&quot; placeholder=&quot;邮箱&quot; auto-focus /&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">      &lt;view class=&quot;section&quot;&gt;</span><br><span class="line">        &lt;input type=&quot;text&quot; placeholder=&quot;密码&quot; /&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">      &lt;view class=&quot;section&quot;&gt;</span><br><span class="line">        &lt;view class=&quot;btn-area&quot;&gt;</span><br><span class="line">           &lt;button type=&quot;primary&quot; &gt;登录&lt;/button&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line"></span><br><span class="line">      &lt;view class=&quot;section&quot;&gt;</span><br><span class="line">      &lt;view class=&quot;btn-area&quot;&gt;</span><br><span class="line">        &lt;button type=&quot;default&quot; bindtap=&quot;gotoregister&quot;&gt;新用户注册&lt;/button&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">    &lt;view class=&quot;section&quot;&gt;</span><br><span class="line">      &lt;view class=&quot;btn-area&quot;&gt;</span><br><span class="line">        &lt;button type=&quot;default&quot; bindtap=&quot;forgotpassword&quot;&gt;忘记密码&lt;/button&gt;</span><br><span class="line">      &lt;/view&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">&lt;/view&gt;</span><br></pre></td></tr></table></figure>
<h1 id="十四、项目一-3-登录按钮功能"><a href="#十四、项目一-3-登录按钮功能" class="headerlink" title="十四、项目一(3)登录按钮功能"></a>十四、项目一(3)登录按钮功能</h1><p>本章涉及文档-API-界面-交互反馈-wx.showModal（显示模态弹窗）、wx.showToast（显示消息提示框）</p>
<h2 id="1、界面"><a href="#1、界面" class="headerlink" title="1、界面"></a>1、界面</h2><p>1）在index.wxml加入文字“首页”（用来识别这一页是首页）</p>
<p>2）在login.wxml，登录部分改成<code>&lt;button type=&quot;primary&quot; ontap=&quot;login&quot;&gt;登录&lt;/button&gt;</code></p>
<p>3）在login.js，加入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">login: function (e) &#123;</span><br><span class="line">  wx.showToast(&#123; </span><br><span class="line">    title: &apos;登录请求中&apos;, </span><br><span class="line">    icon: &apos;loading&apos;, </span><br><span class="line">    duration: 10000 </span><br><span class="line">&#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="2、网络请求-1"><a href="#2、网络请求-1" class="headerlink" title="2、网络请求"></a>2、网络请求</h2><blockquote>
<p>注意：在Q&amp;A里说，发布的时候要求是https请求，tls仅支持1.2及以上版本。</p>
<p>要用chrome浏览器-检查-Security，查看你真实部署的API后台的https版本。</p>
</blockquote>
<p><img src="https://ws3.sinaimg.cn/large/006tNc79gy1fmhayfa61xj30r70eb76f.jpg" alt="Snip20171214_10"></p>
<p>1）login.js加入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">Page(&#123;</span><br><span class="line">  data: &#123;</span><br><span class="line">    email: &apos;&apos;,</span><br><span class="line">    password: &apos;&apos;</span><br><span class="line">  &#125;,</span><br><span class="line">  login: function (e) &#123;</span><br><span class="line">    wx.showToast(&#123;</span><br><span class="line">      title: &apos;登录请求中&apos;,</span><br><span class="line">      icon: &apos;loading&apos;,</span><br><span class="line">      duration: 10000</span><br><span class="line">    &#125;);</span><br><span class="line">    //网络请求开始</span><br><span class="line">    wx.request(&#123;</span><br><span class="line">      url: &apos;https://api.gugujiankong.com/account/Login?email=&apos; + this.data.email + &apos;&amp;password=&apos; + this.data.password</span><br><span class="line">    )&#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>2）表单输入值的获取<code>bindinput=&quot;&quot;</code>（用来获取前台用户输入的账号、密码）</p>
<p>修改login.xwml如下：</p>
<p><code>&lt;input type=&quot;text&quot; bindinput=&quot;bindEmailInput&quot; placeholder=&quot;邮箱&quot; auto-focus /&gt;</code></p>
<p><code>&lt;input type=&quot;password&quot; bindinput=&quot;bindPasswordInput&quot; placeholder=&quot;密码&quot; /&gt;</code></p>
<p>3）login.js后台定义上边的两个方法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">bindEmailInput: function (e) &#123;</span><br><span class="line">  this.setData(&#123; email: e.detail.value &#125;)</span><br><span class="line">&#125;,</span><br><span class="line">bindPasswordInput: function (e) &#123;</span><br><span class="line">  this.setData(&#123; password: e.detail.value &#125;)</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<blockquote>
<p>xx.detail.value的用法案例可以查看官方文档-组件-表单组件-input</p>
</blockquote>
<p>4）login.js的api部分加header和success</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">header: &#123;</span><br><span class="line">  &apos;Content-Type&apos;: &apos;application/json&apos;</span><br><span class="line">&#125;,</span><br><span class="line">success: function (res) &#123;</span><br><span class="line">  wx.hideToast();</span><br><span class="line">  if (res.data.LoginStatus == 1) &#123;</span><br><span class="line">    //进行一些用户状态的存储</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    wx.showModal(&#123;</span><br><span class="line">      title: &apos;登录失败&apos;, content: &apos;请检查您填写的用户信息！&apos;, showCancel: false, success: function (res) &#123;</span><br><span class="line">        //回调函数</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="3、课程回顾"><a href="#3、课程回顾" class="headerlink" title="3、课程回顾"></a>3、课程回顾</h2><p>1）如何获取表单的值？</p>
<p>通过回调的形式，在后台用<code>.detail.value</code>方法获得值，然后在前台调用。</p>
<blockquote>
<p>当某个函数（更确切的说是函数的指针）被作为参数，被另一个函数调用时，它才是回调函数。</p>
</blockquote>
<p>2）登录的时候</p>
<p>①、组件wx.showToast的使用</p>
<p>②、https的注意事项</p>
<p>③、header如何配置</p>
<p>④、在回调的时候做一些状态的处理，比如wx.showModal（显示模态弹窗）、wx.showToast（显示消息提示框）</p>
<h1 id="十五、项目一-4-导航-页面跳转"><a href="#十五、项目一-4-导航-页面跳转" class="headerlink" title="十五、项目一(4)导航-页面跳转"></a>十五、项目一(4)导航-页面跳转</h1><p>本章涉及文档-API-界面-导航</p>
<p>wx.navigateTo，保留当前页面，跳转到应用内的某个页面；</p>
<p>wx.redirectTo，关闭当前页面，跳转到应用内的某个页面。</p>
<p>wx.switchTab，跳转到 tabBar 页面，并关闭其他所有非 tabBar 页面。（用于没有登录时看不到底部tarbar）</p>
<h2 id="1、进行tab的切换"><a href="#1、进行tab的切换" class="headerlink" title="1、进行tab的切换"></a>1、进行tab的切换</h2><p>1）login.js页面，</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">wx.switchTab(&#123;</span><br><span class="line">  url: &apos;../../pages/index/index&apos;,</span><br><span class="line">  success: function () &#123;</span><br><span class="line">    console.log(&quot;called switchtab.&quot;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h2 id="2、【问题】"><a href="#2、【问题】" class="headerlink" title="2、【问题】"></a>2、【问题】</h2><p>1）测试用来登录的账号密码，在哪里设置，尝试login.js和index.js的data位置都失败了？</p>
<h1 id="十六、项目一-5-自己写的API如何让微信接受"><a href="#十六、项目一-5-自己写的API如何让微信接受" class="headerlink" title="十六、项目一(5)自己写的API如何让微信接受"></a>十六、项目一(5)自己写的API如何让微信接受</h1><p>1.tls 仅支持 1.2 及以上版本；</p>
<p>2.部分 Android 机型需要 tls1.0 或者 tls1.1，所以请确保服务器的 tls 版本为 1.0、1.1、1.2；</p>
<p>即需要tls是1.2版本并向下兼容。</p>
<h2 id="1、检测工具"><a href="#1、检测工具" class="headerlink" title="1、检测工具"></a>1、检测工具</h2><p>1）<a href="http://ssl-checker.online-domain-tools.com/" target="_blank" rel="noopener">OnlineDomainTools</a>，用于检测网站tls版本支持等情况。</p>
<p>Domain name，填的是不带https的域名，注意不是填api接口的网址。比如<code>api.gugujiankong.com</code>；</p>
<p>Port，端口默认443；</p>
<p>Ip，可以不填；</p>
<p><img src="https://ws1.sinaimg.cn/large/006tNc79gy1fmhay91i6qj30ki0c175s.jpg" alt="Snip20171214_15"></p>
<p>2）<a href="ipv6-test.com">ipv6 test</a>，做ios开发时，或api不仅仅给微信小程序用还给ios用。</p>
<blockquote>
<p>尽量让自己的API接口支持https，不管是从安全性，还是从apple的ios、微信小程序的支持，都是必备的。</p>
</blockquote>
<h2 id="2、【问题】-1"><a href="#2、【问题】-1" class="headerlink" title="2、【问题】"></a>2、【问题】</h2><p>1）如何快速配置ipv6？</p>
<h1 id="十七、项目一-6-地图"><a href="#十七、项目一-6-地图" class="headerlink" title="十七、项目一(6)地图"></a>十七、项目一(6)地图</h1><p>文档-组件-地图-map，地图不是逻辑和代码困难，主要是一些基础的概念。</p>
<h2 id="1、几个重要的概念"><a href="#1、几个重要的概念" class="headerlink" title="1、几个重要的概念"></a>1、几个重要的概念</h2><p>1）longitude经度，</p>
<p>2）latitude纬度，</p>
<blockquote>
<p>注意：如果用高德地图，当你要给定一个经纬度做标记时，必须用<a href="https://lbs.amap.com/api" target="_blank" rel="noopener">高德地图API</a>的地图工具-坐标拾取器。</p>
</blockquote>
<p>3）scale，放大的级别</p>
<p>4）controltap事件</p>
<p>5）markers事件，就是可以在上边标一些点</p>
<p>6）show-location，显示当前位置</p>
<h2 id="2、代码-2"><a href="#2、代码-2" class="headerlink" title="2、代码"></a>2、代码</h2><p>1）index.wxml改成</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--index.wxml--&gt;</span><br><span class="line">&lt;view class=&quot;container&quot;&gt;</span><br><span class="line">  &lt;map id=&quot;map&quot; longitude=&quot;116.397428&quot; latitude=&quot;39.907913&quot; scale=&quot;14&quot; markers=&quot;&#123;&#123;markers&#125;&#125;&quot; style=&quot;width:100%;height:300px;&quot;&gt;&lt;/map&gt;</span><br><span class="line">&lt;/view&gt;</span><br></pre></td></tr></table></figure>
<p>刷新可以看到首页出现地图：</p>
<p><img src="https://ws4.sinaimg.cn/large/006tNc79gy1fmhaxihv7ij307q0dtjrv.jpg" alt="Snip20171214_16"></p>
<p>2）为了在地图上标点，定义上边引用的markers。</p>
<p>index.js改为</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Page(&#123;</span><br><span class="line">  data: &#123;</span><br><span class="line">   markers: [&#123;</span><br><span class="line">     iconPath: &quot;http://webapi.amap.com/theme/v1.3/markers/b/mark_bs.png&quot;,</span><br><span class="line">     id: 0,</span><br><span class="line">     latitude: 39.907354,</span><br><span class="line">     longitude: 116.397557,</span><br><span class="line">     width: 19,</span><br><span class="line">     height: 33</span><br><span class="line">   &#125;]&#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h2 id="3、四个Tip"><a href="#3、四个Tip" class="headerlink" title="3、四个Tip"></a>3、四个Tip</h2><p>1）<code>map</code> 组件是由客户端创建的原生组件，它的层级是最高的，不能通过 z-index 控制层级。</p>
<p>2）<code>tip</code>: 请勿在 <code>scroll-view</code>、<code>swiper</code>、<code>picker-view</code>、<code>movable-view</code> 中使用 <code>map</code> 组件。</p>
<p>3）<code>tip</code>: <code>css</code> 动画对 <code>map</code> 组件无效。</p>
<p>4）<code>tip</code>: <code>map</code> 组件使用的经纬度是火星坐标系，调用 <code>wx.getLocation</code> 接口需要指定 <code>type</code>为 <code>gcj02</code></p>
<h1 id="十八、flex的布局"><a href="#十八、flex的布局" class="headerlink" title="十八、flex的布局"></a>十八、flex的布局</h1><p>文档-组件-视图容器-view，官方文档讲的太简单了比较让人迷惑。</p>
<p>1）<a href="http://cssreference.parryqiu.com" target="_blank" rel="noopener">css-reference</a>，在github上的项目已翻译成中文文档。大家可以看flexbox章节。</p>
<h1 id="十九、项目一-7-微信登录"><a href="#十九、项目一-7-微信登录" class="headerlink" title="十九、项目一(7)微信登录"></a>十九、项目一(7)微信登录</h1><p>文档-API-用户信息-wx.getUserInfo</p>
<h2 id="1、wx-getUserInfo"><a href="#1、wx-getUserInfo" class="headerlink" title="1、wx.getUserInfo"></a>1、wx.getUserInfo</h2><p>1）获取用户信息，withCredentials 为 true 时需要先调用 <a href="https://mp.weixin.qq.com/debug/wxadoc/dev/api/api-login.html#wxloginobject" target="_blank" rel="noopener">wx.login</a> 接口。</p>
<p>2）需要<a href="https://mp.weixin.qq.com/debug/wxadoc/dev/api/authorize-index.html" target="_blank" rel="noopener">用户授权</a> scope.userInfo</p>
<h2 id="2、代码（官方新建专案就有）"><a href="#2、代码（官方新建专案就有）" class="headerlink" title="2、代码（官方新建专案就有）"></a>2、代码（官方新建专案就有）</h2><p>1）app.js</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">  // 登录</span><br><span class="line">  wx.login(&#123;</span><br><span class="line">    success: res =&gt; &#123;</span><br><span class="line">      // 发送 res.code 到后台换取 openId, sessionKey, unionId</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  // 获取用户信息</span><br><span class="line">  wx.getSetting(&#123;</span><br><span class="line">    success: res =&gt; &#123;</span><br><span class="line">      if (res.authSetting[&apos;scope.userInfo&apos;]) &#123;</span><br><span class="line">        // 已经授权，可以直接调用 getUserInfo 获取头像昵称，不会弹框</span><br><span class="line">        wx.getUserInfo(&#123;</span><br><span class="line">          success: res =&gt; &#123;</span><br><span class="line">            // 可以将 res 发送给后台解码出 unionId</span><br><span class="line">            this.globalData.userInfo = res.userInfo</span><br><span class="line"></span><br><span class="line">            // 由于 getUserInfo 是网络请求，可能会在 Page.onLoad 之后才返回</span><br><span class="line">            // 所以此处加入 callback 以防止这种情况</span><br><span class="line">            if (this.userInfoReadyCallback) &#123;</span><br><span class="line">              this.userInfoReadyCallback(res)</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<p>2）index.js如下。在页面onload的时候，可以把userInfo从globalData里取出来，给前台index.wxml调用    </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">onLoad: function () &#123;</span><br><span class="line">    if (app.globalData.userInfo) &#123;</span><br><span class="line">      this.setData(&#123;</span><br><span class="line">        userInfo: app.globalData.userInfo,</span><br><span class="line">        hasUserInfo: true</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125; else if (this.data.canIUse)&#123;</span><br><span class="line">      // 由于 getUserInfo 是网络请求，可能会在 Page.onLoad 之后才返回</span><br><span class="line">      // 所以此处加入 callback 以防止这种情况</span><br><span class="line">      app.userInfoReadyCallback = res =&gt; &#123;</span><br><span class="line">        this.setData(&#123;</span><br><span class="line">          userInfo: res.userInfo,</span><br><span class="line">          hasUserInfo: true</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      // 在没有 open-type=getUserInfo 版本的兼容处理</span><br><span class="line">      wx.getUserInfo(&#123;</span><br><span class="line">        success: res =&gt; &#123;</span><br><span class="line">          app.globalData.userInfo = res.userInfo</span><br><span class="line">          this.setData(&#123;</span><br><span class="line">            userInfo: res.userInfo,</span><br><span class="line">            hasUserInfo: true</span><br><span class="line">          &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  getUserInfo: function(e) &#123;</span><br><span class="line">    console.log(e)</span><br><span class="line">    app.globalData.userInfo = e.detail.userInfo</span><br><span class="line">    this.setData(&#123;</span><br><span class="line">      userInfo: e.detail.userInfo,</span><br><span class="line">      hasUserInfo: true</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>3）index.wxml，调用昵称等信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;text class=&quot;userinfo-nickname&quot;&gt;&#123;&#123;userInfo.nickName&#125;&#125;&lt;/text&gt;</span><br></pre></td></tr></table></figure>
<h2 id="3、unionID（比较重要）"><a href="#3、unionID（比较重要）" class="headerlink" title="3、unionID（比较重要）"></a>3、unionID（比较重要）</h2><p>1）用来做统一的登录识别。</p>
<p>比如在京东web可以用微信登录、京东公众号用微信登录、京东还有微信小程序，三个平台的用户都是扫二维码登录，用unionID就能识别成一个用户，比如用户信息、订单可以通用。</p>
<p>2）一个app对应一个openID，所以不能通过openID。</p>
<p>4、【问题】如何通过后端API，换取openID？</p>

    </div>

    <div class="post-footer">
        <div>
            
                转载声明：商业转载请联系作者获得授权,非商业转载请注明出处 © <a href="" target="_blank">by 99</a>
            
        </div>
        <div>
            
        </div>
    </div>
</article>

<div class="article-nav prev-next-wrap clearfix">
    
        <a href="/posts/95e2352e/" class="pre-post btn btn-default"><i class="fa fa-angle-left fa-fw"></i>上一篇</a>
    
    
        <a href="/posts/2d4a7783/" class="next-post btn btn-default">下一篇<i class="fa fa-angle-right fa-fw"></i></a>
    
</div>


    <div id="comments">
        
	
<div id="lv-container" data-id="city" data-uid="MTAyMC8zMzE1My85NzEx">
  <script type="text/javascript">
     (function(d, s) {
         var j, e = d.getElementsByTagName(s)[0];
         if (typeof LivereTower === 'function') { return; }
         j = d.createElement(s);
         j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
         j.async = true;
         e.parentNode.insertBefore(j, e);
     })(document, 'script');
  </script>
</div>


    </div>


            </main>
            
    <aside class="col-md-3 sidebar">
        
        <!-- 
    <div class="widget">
        <h3 class="title">Search</h3>
        <div id="search-form">
            <div id="result-mask" class="hide"></div>
            <div class="search-area">
                
                    <input id="search-key" type="search" autocomplete="off" placeholder="搜点什么呢?">
                    <button type="button" class="search-form-submit" id="search-local">搜索</button>
                
                
            </div>
            <div id="result-wrap" class="hide">
                <div id="search-result"></div>
            </div>
            <div class="hide">
                <template id="search-tpl">
                    <div class="item">
                        <a href="/{path}" title="{title}">
                            <div class="title">{title}</div>
                            <div class="content">{content}</div>
                        </a>
                    </div>
                </template>
            </div>
        </div>
    </div>
 -->

        
        
    <div class="widget notification">
        <h3 class="title">网站公告</h3>
        <div>
            <p>你好，我是99。<br/>欢迎来到我的博客。<br/>
<br/>
<hr/>接受贡献，包括不限于提交问题与需求，修复代码。欢迎Pull Request<br/>支持主题：<a href="https://github.com/shenliyang/hexo-theme-snippet/stargazers">Star一下</a>
</p>
        </div>
    </div>

        
        
    <div class="widget">
      <h3 class="title">Social</h3> 
        <div class="content social">
            
	            <a href="//github.com/shenliyang" rel="external nofollow" title="Github" target="_blank">
			    	<i class="git fa fa-git"></i>
			    </a>
            
	            <a href="mailto:snippet@91h5.cc" rel="external nofollow" title="邮箱" target="_blank">
			    	<i class="envelope-o fa fa-envelope-o"></i>
			    </a>
            
	            <a href="/" rel="external nofollow" title="联系QQ" target="_blank">
			    	<i class="qq fa fa-qq"></i>
			    </a>
            
	            <a href="/" rel="external nofollow" title="微博" target="_blank">
			    	<i class="weibo fa fa-weibo"></i>
			    </a>
            
	            <a href="/" rel="external nofollow" title="QQ群" target="_blank">
			    	<i class="users fa fa-users"></i>
			    </a>
            
	            <a href="/atom.xml" rel="external nofollow" title="RSS" target="_blank">
			    	<i class="feed fa fa-feed"></i>
			    </a>
            
        </div>
    </div>


        
        
    <div class="widget">
        <h3 class="title">Categories</h3>
        <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/ror功能/"><i class="fa" aria-hidden="true">ror功能</i></a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/ror知识点/"><i class="fa" aria-hidden="true">ror知识点</i></a><span class="category-list-count">26</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/ror系统/"><i class="fa" aria-hidden="true">ror系统</i></a><span class="category-list-count">21</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/web页面/"><i class="fa" aria-hidden="true">web页面</i></a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/工具/"><i class="fa" aria-hidden="true">工具</i></a><span class="category-list-count">23</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/微信小程序/"><i class="fa" aria-hidden="true">微信小程序</i></a><span class="category-list-count">14</span></li><li class="category-list-item"><a class="category-list-link current" href="/categories/心得/"><i class="fa" aria-hidden="true">心得</i></a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/投资/"><i class="fa" aria-hidden="true">投资</i></a><span class="category-list-count">1</span></li></ul>
    </div>


        
        
    <div class="widget">
      <h3 class="title">Archives</h3>
        <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/"><i class="fa" aria-hidden="true">January 2018</i></a><span class="archive-list-count">31</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/"><i class="fa" aria-hidden="true">December 2017</i></a><span class="archive-list-count">35</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/"><i class="fa" aria-hidden="true">November 2017</i></a><span class="archive-list-count">35</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/"><i class="fa" aria-hidden="true">September 2017</i></a><span class="archive-list-count">1</span></li></ul>
    </div>


        
        
  <div class="widget">
    <h3 class="title">Tag Cloud</h3>
    <div class="content tag-cloud">
        <a href="/tags/atom/" style="font-size: 14px;">atom</a> <a href="/tags/bug/" style="font-size: 18px;">bug</a> <a href="/tags/heroku/" style="font-size: 10px;">heroku</a> <a href="/tags/hexo/" style="font-size: 12px;">hexo</a> <a href="/tags/interview/" style="font-size: 11px;">interview</a> <a href="/tags/mac/" style="font-size: 12px;">mac</a> <a href="/tags/orid-day/" style="font-size: 10px;">orid-day</a> <a href="/tags/orid-month/" style="font-size: 11px;">orid-month</a> <a href="/tags/ror功能/" style="font-size: 14px;">ror功能</a> <a href="/tags/ror知识点/" style="font-size: 17px;">ror知识点</a> <a href="/tags/ror系统/" style="font-size: 19px;">ror系统</a> <a href="/tags/stackoverflow/" style="font-size: 10px;">stackoverflow</a> <a href="/tags/typora/" style="font-size: 10px;">typora</a> <a href="/tags/vps/" style="font-size: 16px;">vps</a> <a href="/tags/web页面/" style="font-size: 12px;">web页面</a> <a href="/tags/下载/" style="font-size: 10px;">下载</a> <a href="/tags/工具/" style="font-size: 20px;">工具</a> <a href="/tags/常用/" style="font-size: 13px;">常用</a> <a href="/tags/微信功能/" style="font-size: 13px;">微信功能</a> <a href="/tags/微信系统/" style="font-size: 15px;">微信系统</a> <a href="/tags/微信页面/" style="font-size: 11px;">微信页面</a> <a href="/tags/心得/" style="font-size: 15px;">心得</a> <a href="/tags/手机/" style="font-size: 10px;">手机</a> <a href="/tags/投资/" style="font-size: 10px;">投资</a> <a href="/tags/搬砖/" style="font-size: 10px;">搬砖</a> <a href="/tags/核聚编程/" style="font-size: 12px;">核聚编程</a> <a href="/tags/科学上网/" style="font-size: 14px;">科学上网</a> <a href="/tags/部署/" style="font-size: 13px;">部署</a>
    </div>
  </div>


        
        
    <div class="widget">
        <h3 class="title">Friends</h3>
        <div class="content friends-link">
        
            <a href="http://www.shenliyang.com" class="fa" target="_blank">个人博客</a>
        
        </div>
    </div>


        
    </aside>


        </div>
      </section>
    </div>
  </div>
    <footer class="main-footer">
    <div class="container">
        <div class="row">
        </div>
    </div>
</footer>

<a id="back-to-top" class="hide">
	<i class="fa fa-chevron-up"></i>
</a>




    <div class="copyright">
    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                <span>Copyright &copy; 2018
                </span> |
                <span>
                    Powered by <a href="//hexo.io" class="copyright-links" target="_blank" rel="nofollow">Hexo</a>
                </span> |
                <span>
                    Theme by <a href="//github.com/shenliyang/hexo-theme-snippet.git" class="copyright-links" target="_blank" rel="nofollow">Snippet</a>
                </span>
            </div>
        </div>
    </div>
</div>



	<script src="/js/search.js?rev=@@hash"></script>


<script src="/js/app.js?rev=@@hash"></script>


</body>
</html>
